import{gE as Me}from"./chunk-JaFSy54E.js";import{e as Oe}from"./chunk-D_yTKJJf.js";import{c as we}from"./chunk-DhngCxSs.js";import{d as ke,r as Ve}from"./chunk-DW0GXzYX.js";/* @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const P=5120,_=5121,z=5122,L=5123,C=5124,M=5125,O=5126,$e=32819,Ge=32820,He=33635,ge=5131,Ye=33640,We=35899,je=35902,Ke=36269,Xe=34042,q={};{const e=q;e[P]=Int8Array,e[_]=Uint8Array,e[z]=Int16Array,e[L]=Uint16Array,e[C]=Int32Array,e[M]=Uint32Array,e[O]=Float32Array,e[$e]=Uint16Array,e[Ge]=Uint16Array,e[He]=Uint16Array,e[ge]=Uint16Array,e[Ye]=Uint32Array,e[We]=Uint32Array,e[je]=Uint32Array,e[Ke]=Uint32Array,e[Xe]=Uint32Array}function Z(e){if(e instanceof Int8Array)return P;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return _;if(e instanceof Int16Array)return z;if(e instanceof Uint16Array)return L;if(e instanceof Int32Array)return C;if(e instanceof Uint32Array)return M;if(e instanceof Float32Array)return O;throw new Error("unsupported typed array type")}function J(e){if(e===Int8Array)return P;if(e===Uint8Array||e===Uint8ClampedArray)return _;if(e===Int16Array)return z;if(e===Uint16Array)return L;if(e===Int32Array)return C;if(e===Uint32Array)return M;if(e===Float32Array)return O;throw new Error("unsupported typed array type")}function qe(e){const t=q[e];if(!t)throw new Error("unknown gl type");return t}const D=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function Ze(...e){console.error(...e)}const W=new Map;function Q(e,t){if(!e||typeof e!="object")return!1;let r=W.get(t);r||(r=new WeakMap,W.set(t,r));let o=r.get(e);if(o===void 0){const n=Object.prototype.toString.call(e);o=n.substring(8,n.length-1)===t,r.set(e,o)}return o}function Je(e,t){return typeof WebGLBuffer<"u"&&Q(t,"WebGLBuffer")}function ee(e,t){return typeof WebGLTexture<"u"&&Q(t,"WebGLTexture")}const te=35044,x=34962,Qe=34963,et=34660,tt=5120,rt=5121,nt=5122,ot=5123,it=5124,st=5125,re=5126,ne={attribPrefix:""};function ct(e,t,r,o,n){e.bindBuffer(t,r),e.bufferData(t,o,n||te)}function oe(e,t,r,o){if(Je(e,t))return t;r=r||x;const n=e.createBuffer();return ct(e,r,n,t,o),n}function ie(e){return e==="indices"}function ft(e){return e===Int8Array||e===Uint8Array}function at(e){return e.length?e:e.data}const ut=/coord|texture/i,mt=/color|colour/i;function lt(e,t){let r;if(ut.test(e)?r=2:mt.test(e)?r=4:r=3,t%r>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${r} but ${t} values is not evenly divisible by ${r}. You should specify it.`);return r}function At(e,t,r){return e.numComponents||e.size||lt(t,r||at(e).length)}function se(e,t){if(D(e))return e;if(D(e.data))return e.data;Array.isArray(e)&&(e={data:e});let r=e.type?w(e.type):void 0;return r||(ie(t)?r=Uint16Array:r=Float32Array),new r(e.data)}function dt(e){return typeof e=="number"?e:e?J(e):re}function w(e){return typeof e=="number"?qe(e):e||Float32Array}function yt(e,t){return{buffer:t.buffer,numValues:2*3*4,type:dt(t.type),arrayType:w(t.type)}}function Tt(e,t){const r=t.data||t,o=w(t.type),n=r*o.BYTES_PER_ELEMENT,s=e.createBuffer();return e.bindBuffer(x,s),e.bufferData(x,n,t.drawType||te),{buffer:s,numValues:r,type:J(o),arrayType:o}}function Et(e,t,r){const o=se(t,r);return{arrayType:o.constructor,buffer:oe(e,o,void 0,t.drawType),type:Z(o),numValues:0}}function St(e,t){const r={};return Object.keys(t).forEach(function(o){if(!ie(o)){const n=t[o],s=n.attrib||n.name||n.attribName||ne.attribPrefix+o;if(n.value){if(!Array.isArray(n.value)&&!D(n.value))throw new Error("array.value is not array or typedarray");r[s]={value:n.value}}else{let c;n.buffer&&n.buffer instanceof WebGLBuffer?c=yt:typeof n=="number"||typeof n.data=="number"?c=Tt:c=Et;const{buffer:i,type:f,numValues:a,arrayType:m}=c(e,n,o),l=n.normalize!==void 0?n.normalize:ft(m),T=At(n,o,a);r[s]={buffer:i,numComponents:T,type:f,normalize:l,stride:n.stride||0,offset:n.offset||0,divisor:n.divisor===void 0?void 0:n.divisor,drawType:n.drawType}}}}),e.bindBuffer(x,null),r}function pt(e,t){return t===tt||t===rt?1:t===nt||t===ot?2:t===it||t===st||t===re?4:0}const U=["position","positions","a_position"];function xt(e,t){let r,o;for(o=0;o<U.length&&(r=U[o],!(r in t||(r=ne.attribPrefix+r,r in t)));++o);o===U.length&&(r=Object.keys(t)[0]);const n=t[r];if(!n.buffer)return 1;e.bindBuffer(x,n.buffer);const s=e.getBufferParameter(x,et);e.bindBuffer(x,null);const c=pt(e,n.type),i=s/c,f=n.numComponents||n.size,a=i/f;if(a%1!==0)throw new Error(`numComponents ${f} not correct for length ${length}`);return a}function _t(e,t,r){const o=St(e,t),n=Object.assign({},r||{});n.attribs=Object.assign({},r?r.attribs:{},o);const s=t.indices;if(s){const c=se(s,"indices");n.indices=oe(e,c,Qe),n.numElements=c.length,n.elementType=Z(c)}else n.numElements||(n.numElements=xt(e,n.attribs));return n}function k(e){return!!e.texStorage2D}const bt=function(){const e={},t={};function r(o){const n=o.constructor.name;if(!e[n]){for(const s in o)if(typeof o[s]=="number"){const c=t[o[s]];t[o[s]]=c?`${c} | ${s}`:s}e[n]=!0}}return function(n,s){return r(n),t[s]||(typeof s=="number"?`0x${s.toString(16)}`:s)}}(),V=Ze;function ce(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}const b=33984,v=34962,vt=34963,ht=35713,It=35714,Nt=35632,Bt=35633,Ft=35981,fe=35718,Rt=35721,Ut=35971,Dt=35382,Pt=35396,zt=35398,Lt=35392,Ct=35395,h=5126,ae=35664,ue=35665,me=35666,$=5124,le=35667,Ae=35668,de=35669,ye=35670,Te=35671,Ee=35672,Se=35673,pe=35674,xe=35675,_e=35676,Mt=35678,Ot=35680,wt=35679,kt=35682,Vt=35685,$t=35686,Gt=35687,Ht=35688,gt=35689,Yt=35690,Wt=36289,jt=36292,Kt=36293,G=5125,be=36294,ve=36295,he=36296,Xt=36298,qt=36299,Zt=36300,Jt=36303,Qt=36306,er=36307,tr=36308,rr=36311,I=3553,N=34067,H=32879,B=35866,u={};function Ie(e,t){return u[t].bindPoint}function nr(e,t){return function(r){e.uniform1f(t,r)}}function or(e,t){return function(r){e.uniform1fv(t,r)}}function ir(e,t){return function(r){e.uniform2fv(t,r)}}function sr(e,t){return function(r){e.uniform3fv(t,r)}}function cr(e,t){return function(r){e.uniform4fv(t,r)}}function Ne(e,t){return function(r){e.uniform1i(t,r)}}function Be(e,t){return function(r){e.uniform1iv(t,r)}}function Fe(e,t){return function(r){e.uniform2iv(t,r)}}function Re(e,t){return function(r){e.uniform3iv(t,r)}}function Ue(e,t){return function(r){e.uniform4iv(t,r)}}function fr(e,t){return function(r){e.uniform1ui(t,r)}}function ar(e,t){return function(r){e.uniform1uiv(t,r)}}function ur(e,t){return function(r){e.uniform2uiv(t,r)}}function mr(e,t){return function(r){e.uniform3uiv(t,r)}}function lr(e,t){return function(r){e.uniform4uiv(t,r)}}function Ar(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}}function dr(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}}function yr(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}}function Tr(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}}function Er(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}}function Sr(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}}function pr(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}}function xr(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}}function _r(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}}function d(e,t,r,o){const n=Ie(e,t);return k(e)?function(s){let c,i;!s||ee(e,s)?(c=s,i=null):(c=s.texture,i=s.sampler),e.uniform1i(o,r),e.activeTexture(b+r),e.bindTexture(n,c),e.bindSampler(r,i)}:function(s){e.uniform1i(o,r),e.activeTexture(b+r),e.bindTexture(n,s)}}function y(e,t,r,o,n){const s=Ie(e,t),c=new Int32Array(n);for(let i=0;i<n;++i)c[i]=r+i;return k(e)?function(i){e.uniform1iv(o,c),i.forEach(function(f,a){e.activeTexture(b+c[a]);let m,l;!f||ee(e,f)?(m=f,l=null):(m=f.texture,l=f.sampler),e.bindSampler(r,l),e.bindTexture(s,m)})}:function(i){e.uniform1iv(o,c),i.forEach(function(f,a){e.activeTexture(b+c[a]),e.bindTexture(s,f)})}}u[h]={Type:Float32Array,size:4,setter:nr,arraySetter:or};u[ae]={Type:Float32Array,size:8,setter:ir,cols:2};u[ue]={Type:Float32Array,size:12,setter:sr,cols:3};u[me]={Type:Float32Array,size:16,setter:cr,cols:4};u[$]={Type:Int32Array,size:4,setter:Ne,arraySetter:Be};u[le]={Type:Int32Array,size:8,setter:Fe,cols:2};u[Ae]={Type:Int32Array,size:12,setter:Re,cols:3};u[de]={Type:Int32Array,size:16,setter:Ue,cols:4};u[G]={Type:Uint32Array,size:4,setter:fr,arraySetter:ar};u[be]={Type:Uint32Array,size:8,setter:ur,cols:2};u[ve]={Type:Uint32Array,size:12,setter:mr,cols:3};u[he]={Type:Uint32Array,size:16,setter:lr,cols:4};u[ye]={Type:Uint32Array,size:4,setter:Ne,arraySetter:Be};u[Te]={Type:Uint32Array,size:8,setter:Fe,cols:2};u[Ee]={Type:Uint32Array,size:12,setter:Re,cols:3};u[Se]={Type:Uint32Array,size:16,setter:Ue,cols:4};u[pe]={Type:Float32Array,size:32,setter:Ar,rows:2,cols:2};u[xe]={Type:Float32Array,size:48,setter:dr,rows:3,cols:3};u[_e]={Type:Float32Array,size:64,setter:yr,rows:4,cols:4};u[Vt]={Type:Float32Array,size:32,setter:Tr,rows:2,cols:3};u[$t]={Type:Float32Array,size:32,setter:Sr,rows:2,cols:4};u[Gt]={Type:Float32Array,size:48,setter:Er,rows:3,cols:2};u[Ht]={Type:Float32Array,size:48,setter:xr,rows:3,cols:4};u[gt]={Type:Float32Array,size:64,setter:pr,rows:4,cols:2};u[Yt]={Type:Float32Array,size:64,setter:_r,rows:4,cols:3};u[Mt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:I};u[Ot]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:N};u[wt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:H};u[kt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:I};u[Wt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:B};u[jt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:B};u[Kt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:N};u[Xt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:I};u[qt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:H};u[Zt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:N};u[Jt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:B};u[Qt]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:I};u[er]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:H};u[tr]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:N};u[rr]={Type:null,size:0,setter:d,arraySetter:y,bindPoint:B};function F(e,t){return function(r){if(r.value)switch(e.disableVertexAttribArray(t),r.value.length){case 4:e.vertexAttrib4fv(t,r.value);break;case 3:e.vertexAttrib3fv(t,r.value);break;case 2:e.vertexAttrib2fv(t,r.value);break;case 1:e.vertexAttrib1fv(t,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(v,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.numComponents||r.size,r.type||h,r.normalize||!1,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function p(e,t){return function(r){if(r.value)if(e.disableVertexAttribArray(t),r.value.length===4)e.vertexAttrib4iv(t,r.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(v,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||$,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function R(e,t){return function(r){if(r.value)if(e.disableVertexAttribArray(t),r.value.length===4)e.vertexAttrib4uiv(t,r.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(v,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||G,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function g(e,t,r){const o=r.size,n=r.count;return function(s){e.bindBuffer(v,s.buffer);const c=s.size||s.numComponents||o,i=c/n,f=s.type||h,m=u[f].size*c,l=s.normalize||!1,T=s.offset||0,E=m/n;for(let S=0;S<n;++S)e.enableVertexAttribArray(t+S),e.vertexAttribPointer(t+S,i,f,l,m,T+E*S),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+S,s.divisor||0)}}const A={};A[h]={size:4,setter:F};A[ae]={size:8,setter:F};A[ue]={size:12,setter:F};A[me]={size:16,setter:F};A[$]={size:4,setter:p};A[le]={size:8,setter:p};A[Ae]={size:12,setter:p};A[de]={size:16,setter:p};A[G]={size:4,setter:R};A[be]={size:8,setter:R};A[ve]={size:12,setter:R};A[he]={size:16,setter:R};A[ye]={size:4,setter:p};A[Te]={size:8,setter:p};A[Ee]={size:12,setter:p};A[Se]={size:16,setter:p};A[pe]={size:4,setter:g,count:2};A[xe]={size:9,setter:g,count:3};A[_e]={size:16,setter:g,count:4};const br=/ERROR:\s*\d+:(\d+)/gi;function vr(e,t="",r=0){const o=[...t.matchAll(br)],n=new Map(o.map((s,c)=>{const i=parseInt(s[1]),f=o[c+1],a=f?f.index:t.length,m=t.substring(s.index,a);return[i-1,m]}));return e.split(`
`).map((s,c)=>{const i=n.get(c);return`${c+1+r}: ${s}${i?`

^^^ ${i}`:""}`}).join(`
`)}const j=/^[ \t]*\n/;function De(e){let t=0;return j.test(e)&&(t=1,e=e.replace(j,"")),{lineOffset:t,shaderSource:e}}function hr(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}
${e.errors.join(`
`)}`)}),null}function Ir(e,t,r,o){if(o=o||V,!e.getShaderParameter(r,ht)){const s=e.getShaderInfoLog(r),{lineOffset:c,shaderSource:i}=De(e.getShaderSource(r)),f=`${vr(i,s,c)}
Error compiling ${bt(e,t)}: ${s}`;return o(f),f}return""}function Y(e,t,r){let o,n,s;if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function")r=e,e=void 0;else if(e&&!Array.isArray(e)){const a=e;r=a.errorCallback,e=a.attribLocations,o=a.transformFeedbackVaryings,n=a.transformFeedbackMode,s=a.callback}const c=r||V,i=[],f={errorCallback(a,...m){i.push(a),c(a,...m)},transformFeedbackVaryings:o,transformFeedbackMode:n,callback:s,errors:i};{let a={};Array.isArray(e)?e.forEach(function(m,l){a[m]=t?t[l]:l}):a=e||{},f.attribLocations=a}return f}const Nr=["VERTEX_SHADER","FRAGMENT_SHADER"];function Br(e,t){if(t.indexOf("frag")>=0)return Nt;if(t.indexOf("vert")>=0)return Bt}function Fr(e,t,r){const o=e.getAttachedShaders(t);for(const n of o)r.has(n)&&e.deleteShader(n);e.deleteProgram(t)}const Rr=(e=0)=>new Promise(t=>setTimeout(t,e));function Ur(e,t,r){const o=e.createProgram(),{attribLocations:n,transformFeedbackVaryings:s,transformFeedbackMode:c}=Y(r);for(let i=0;i<t.length;++i){let f=t[i];if(typeof f=="string"){const a=ce(f),m=a?a.text:f;let l=e[Nr[i]];a&&a.type&&(l=Br(e,a.type)||l),f=e.createShader(l),e.shaderSource(f,De(m).shaderSource),e.compileShader(f),e.attachShader(o,f)}}Object.entries(n).forEach(([i,f])=>e.bindAttribLocation(o,f,i));{let i=s;i&&(i.attribs&&(i=i.attribs),Array.isArray(i)||(i=Object.keys(i)),e.transformFeedbackVaryings(o,i,c||Ft))}return e.linkProgram(o),o}function Dr(e,t,r,o,n){const s=Y(r,o,n),c=new Set(t),i=Ur(e,t,s);function f(a,m){const l=zr(a,m,s.errorCallback);return l&&Fr(a,m,c),l}if(s.callback){Pr(e,i).then(()=>{const a=f(e,i);s.callback(a,a?void 0:i)});return}return f(e,i)?void 0:i}async function Pr(e,t){const r=e.getExtension("KHR_parallel_shader_compile"),o=r?(s,c)=>s.getProgramParameter(c,r.COMPLETION_STATUS_KHR):()=>!0;let n=0;do await Rr(n),n=1e3/60;while(!o(e,t))}function zr(e,t,r){if(r=r||V,!e.getProgramParameter(t,It)){const n=e.getProgramInfoLog(t);r(`Error in program linking: ${n}`);const c=e.getAttachedShaders(t).map(i=>Ir(e,e.getShaderParameter(i,e.SHADER_TYPE),i,r));return`${n}
${c.filter(i=>i).join(`
`)}`}}function Lr(e,t,r,o,n){return Dr(e,t,r,o,n)}function Pe(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const Cr=/(\.|\[|]|\w+)/g,Mr=e=>e>="0"&&e<="9";function Or(e,t,r,o){const n=e.split(Cr).filter(i=>i!=="");let s=0,c="";for(;;){const i=n[s++];c+=i;const f=Mr(i[0]),a=f?parseInt(i):i;if(f&&(c+=n[s++]),s===n.length){r[a]=t;break}else{const l=n[s++],T=l==="[",E=r[a]||(T?[]:{});r[a]=E,r=E,o[c]=o[c]||function(S){return function(Ce){ze(S,Ce)}}(E),c+=l}}}function wr(e,t){let r=0;function o(i,f,a){const m=f.name.endsWith("[0]"),l=f.type,T=u[l];if(!T)throw new Error(`unknown type: 0x${l.toString(16)}`);let E;if(T.bindPoint){const S=r;r+=f.size,m?E=T.arraySetter(e,l,S,a,f.size):E=T.setter(e,l,S,a,f.size)}else T.arraySetter&&m?E=T.arraySetter(e,a):E=T.setter(e,a);return E.location=a,E}const n={},s={},c=e.getProgramParameter(t,fe);for(let i=0;i<c;++i){const f=e.getActiveUniform(t,i);if(Pe(f))continue;let a=f.name;a.endsWith("[0]")&&(a=a.substr(0,a.length-3));const m=e.getUniformLocation(t,f.name);if(m){const l=o(t,f,m);n[a]=l,Or(a,l,s,n)}}return n}function kr(e,t){const r={},o=e.getProgramParameter(t,Ut);for(let n=0;n<o;++n){const s=e.getTransformFeedbackVarying(t,n);r[s.name]={index:n,type:s.type,size:s.size}}return r}function Vr(e,t){const r=e.getProgramParameter(t,fe),o=[],n=[];for(let i=0;i<r;++i){n.push(i),o.push({});const f=e.getActiveUniform(t,i);o[i].name=f.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(i){const f=i[0],a=i[1];e.getActiveUniforms(t,n,e[f]).forEach(function(m,l){o[l][a]=m})});const s={},c=e.getProgramParameter(t,Dt);for(let i=0;i<c;++i){const f=e.getActiveUniformBlockName(t,i),a={index:e.getUniformBlockIndex(t,f),usedByVertexShader:e.getActiveUniformBlockParameter(t,i,Pt),usedByFragmentShader:e.getActiveUniformBlockParameter(t,i,zt),size:e.getActiveUniformBlockParameter(t,i,Lt),uniformIndices:e.getActiveUniformBlockParameter(t,i,Ct)};a.used=a.usedByVertexShader||a.usedByFragmentShader,s[f]=a}return{blockSpecs:s,uniformData:o}}function ze(e,t){for(const r in t){const o=e[r];typeof o=="function"?o(t[r]):ze(e[r],t[r])}}function Le(e,...t){const r=e.uniformSetters||e,o=t.length;for(let n=0;n<o;++n){const s=t[n];if(Array.isArray(s)){const c=s.length;for(let i=0;i<c;++i)Le(r,s[i])}else for(const c in s){const i=r[c];i&&i(s[c])}}}function $r(e,t){const r={},o=e.getProgramParameter(t,Rt);for(let n=0;n<o;++n){const s=e.getActiveAttrib(t,n);if(Pe(s))continue;const c=e.getAttribLocation(t,s.name),i=A[s.type],f=i.setter(e,c,i);f.location=c,r[s.name]=f}return r}function Gr(e,t){for(const r in t){const o=e[r];o&&o(t[r])}}function Hr(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(Gr(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(vt,r.indices))}function K(e,t){const r=wr(e,t),o=$r(e,t),n={program:t,uniformSetters:r,attribSetters:o};return k(e)&&(n.uniformBlockSpec=Vr(e,t),n.transformFeedbackInfo=kr(e,t)),n}const gr=/\s|{|}|;/;function Yr(e,t,r,o,n){const s=Y(r,o,n),c=[];if(t=t.map(function(a){if(!gr.test(a)){const m=ce(a);if(m)a=m.text;else{const l=`no element with id: ${a}`;s.errorCallback(l),c.push(l)}}return a}),c.length)return hr(s,"");const i=s.callback;i&&(s.callback=(a,m)=>{i(a,a?void 0:K(e,m))});const f=Lr(e,t,s);return f?K(e,f):null}const Wr=4,X=5123;function jr(e,t,r,o,n,s){r=r===void 0?Wr:r;const c=t.indices,i=t.elementType,f=o===void 0?t.numElements:o;n=n===void 0?0:n,i||c?s!==void 0?e.drawElementsInstanced(r,f,i===void 0?X:t.elementType,n,s):e.drawElements(r,f,i===void 0?X:t.elementType,n):s!==void 0?e.drawArraysInstanced(r,n,f,s):e.drawArrays(r,n,f)}function Kr(e,t,r){const o=e.createVertexArray();return e.bindVertexArray(o),t.length||(t=[t]),t.forEach(function(n){Hr(e,n,r)}),e.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:o}}var Xr=Object.defineProperty,qr=Object.getOwnPropertyDescriptor,Zr=(e,t,r,o)=>{for(var n=o>1?void 0:o?qr(t,r):t,s=e.length-1,c;s>=0;s--)(c=e[s])&&(n=(o?c(t,r,n):c(n))||n);return o&&n&&Xr(t,r,n),n};const rn=ke({__name:"render-node",setup(e){const t=we();let r=class extends Me{constructor(){super(...arguments),this.consumes={required:["composite-color"]},this.produces="composite-color"}get enabled(){return this.produces!=null}set enabled(o){this.produces=o?"composite-color":null,this.requestRender()}destroy(){this.programInfo&&this.gl.deleteProgram(this.programInfo.program)}render(o){const n=o.find(({name:f})=>f==="composite-color");if(!n)throw new Error("composite-color input is required");const s=n.getTexture(),c=this.acquireOutputFramebuffer(),i=this.gl;if(i.clearColor(0,0,0,1),i.colorMask(!0,!0,!0,!0),i.clear(i.COLOR_BUFFER_BIT),this.programInfo||this.setupShaderProgram(i),!this.programInfo)throw new Error("Failed to create shader program");return i.useProgram(this.programInfo.program),Le(this.programInfo,{colorTex:s.glName}),this.vertexArrayInfo?.vertexArrayObject&&(i.bindVertexArray(this.vertexArrayInfo.vertexArrayObject),jr(i,this.vertexArrayInfo)),c.attachDepth(n.getAttachment(i.DEPTH_STENCIL_ATTACHMENT)),c}setupShaderProgram(o){const n=`#version 300 es

                    in vec2 position;
                    out vec2 uv;

                    void main() {
                        gl_Position = vec4(position, 0.0, 1.0);
                        uv = position * 0.5 + vec2(0.5);
                    }`,s=`#version 300 es
    
                        precision highp float;
                        out lowp vec4 fragColor;
    
                        in vec2 uv;
                        uniform sampler2D colorTex;
    
                        void main() {
                            vec4 color = texture(colorTex, uv);
                            fragColor = vec4(
                              vec3(
                                dot(
                                  color.rgb, 
                                  vec3(0.2126, 0.7152, 0.0722)
                                )
                              ), 
                              color.a
                            );
                        }`;this.programInfo=Yr(o,[n,s]);const i={position:{numComponents:2,data:new Float32Array([-1,-1,3,-1,-1,3])}};this.bufferInfo=_t(o,i),this.vertexArrayInfo=Kr(o,this.programInfo,this.bufferInfo)}};return r=Zr([Oe("vuesri.three.LuminanceRenderNode")],r),new r({view:t}),(o,n)=>Ve(o.$slots,"default")}});export{rn as _};
