import{g as w,R as c,u as G,a as b,h as y,c as d,i as g,G as m,b as M,j,k as Z}from"./chunk-BG7do94j.js";import{E as N}from"./chunk-CC8PhC7k.js";import{c as W,p as Y}from"./chunk-DfgFxUOr.js";import"./chunk-DCsN_d27.js";import"./chunk-C4bXDfxA.js";import{M as E}from"./chunk-17Fj8kIi.js";import{y as I,e as f}from"./chunk-D_yTKJJf.js";import{d as B,a as Q,w as U,R as D,r as R}from"./chunk-CN5kXZIc.js";const T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NEM2RDY1MDlFNUY5MTFFQTk0QjQ4MTNBNTVEQTlEMjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NEM2RDY1MEFFNUY5MTFFQTk0QjQ4MTNBNTVEQTlEMjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0QzZENjUwN0U1RjkxMUVBOTRCNDgxM0E1NURBOUQyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0QzZENjUwOEU1RjkxMUVBOTRCNDgxM0E1NURBOUQyNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrIHoe8AAAD/SURBVHja7NzZDYMwFAVRG9F/s+xILK7AQv56wBklDdzROCQhyVdK5YEodCYgBIQQgkb68jzMEEvIZoZYQlYzxBIym4EQVISMZiAEhLxHyGAGQuDIIgSEfEPIZAbv1FERspghlhAfvwcTspshlpDTDISAEELQKMStpAqBQghBC24lVQgUohAohBAQQggIcZWVshkUAoUoBIQ4sqAQQkAIISAEhLzkstc3hoSAEEJACCEg5AdC/BxBISDEkQWFKAQKUQgIcWRBISDEkQWFEAJCvIZAIQqBQqAQhUAhCoFCCIEjSyEgBI4shYAQQkAIISCEEBACQgjBU/xfVjBuAQYAui1NZMQ04dQAAAAASUVORK5CYII=",k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTY2RTZDRENFNURDMTFFQTlFNEFBQzk2RkI5OThFNDUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTY2RTZDRERFNURDMTFFQTlFNEFBQzk2RkI5OThFNDUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNjZFNkNEQUU1REMxMUVBOUU0QUFDOTZGQjk5OEU0NSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBNjZFNkNEQkU1REMxMUVBOUU0QUFDOTZGQjk5OEU0NSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pq9SStYAAAxWSURBVHja7Ftbltu4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",S={source:{type:Array,default:()=>[]},texture:{type:Object,default:()=>{const t=new w().load(T);return t.wrapS=c,t.wrapT=c,t}}},J={load:t=>t},F=B({name:"VathWallLayer",props:S,emits:J,setup(t,{emit:e}){const i=new A({source:t.source}),r=G();return Q(()=>{i.texture=t.texture}),U(()=>t.source,()=>{i.source=t.source,i.refresh()}),b(r,i),e("load",{layer:i,renderer:r,view:r.view}),{}}});function x(t,e,i,r,a,s){return R(t.$slots,"default")}const p=D(F,[["render",x]]);var v=Object.defineProperty,H=Object.getOwnPropertyDescriptor,u=(t,e,i,r)=>{for(var a=r>1?void 0:r?H(e,i):e,s=t.length-1,o;s>=0;s--)(o=t[s])&&(a=(r?o(e,i,a):o(a))||a);return r&&a&&v(e,i,a),a};class V{constructor(e){this.group=new m,this.paths=[],this.graphic=e.graphic,this.layer=e.layer}setup(){this.paths=this.pathsFromGraphic();const i=this.paths.reduce((r,a)=>{const o=this.wallsFromPath(a).map(l=>this.createBufferGeometry(l));return r.concat(o)},[]).map(r=>{const a=new m,s=new M(r,this.layer.material),o=new M(r.clone(),this.layer.backgroundMaterial);return a.add(s),a.add(o),a});this.group.add(...i),this.layer.group.add(this.group)}render(){}dispose(){this.group.clear(),this.layer.group.remove(this.group)}createBufferGeometry(e){const i=this.layer.getRenderTransform().createRenderCoordinatesSync(e),r=new j;r.setAttribute("position",new Z(i,3));const a=[0,1,2,2,3,0];r.setIndex(a);const s=new Float32Array([1,0,0,0,1,1,0,1]);return r.setAttribute("uv",new Z(s,2)),r}pathsFromGraphic(){const e=W(this.graphic.geometry);if(e.type!=="polyline"&&e.type!=="polygon")throw new Error("geometry type must be polyline");return Y(e)}wallsFromPath(e){const i=[];for(let r=0;r<e.length-1;r++){const a=e[r],s=e[r+1];let o=a,l=a;a.z?(o=a.clone(),o.set("z",0)):(l=a.clone(),l.set("z",this.layer.height));let n=s,h=s;s.z?(n=s.clone(),n.set("z",0)):(h=s.clone(),h.set("z",this.layer.height)),i.push([o,n,h,l])}return i}}let A=class extends E(N){constructor(t={}){super(t),this.height=50,this.texture=new y,this.sBackgroundMaterial=Symbol("backgroundMaterial"),this.defaultBackgroundMaterial=new d({color:16711680,side:g,transparent:!0,depthWrite:!1,opacity:.1,alphaMap:(()=>{const e=new w().load(k);return e.wrapS=c,e.wrapT=c,e})()}),t.texture&&(this.texture=t.texture)}init(){this.material=new d({side:g,transparent:!0,depthWrite:!1,map:this.texture,opacity:.6}),this.handles.push(this.watch("texture",()=>{this.getMaterial().map=this.texture})),this.entities=this.source.map(t=>new V({graphic:t,layer:this}))}animate(t){const e=this.getMaterial().map;e&&(e.offset.y<=0?e.offset.set(0,1):e.offset.set(0,e.offset.y-.01),t.renderNode?.requestRender())}get backgroundMaterial(){return this.materialMap.get(this.sBackgroundMaterial)??this.defaultBackgroundMaterial}set backgroundMaterial(t){this.materialMap.set(this.sBackgroundMaterial,t)}getMaterial(){return this.material}};u([I({type:Number})],A.prototype,"height",2);u([I({type:y})],A.prototype,"texture",2);A=u([f("vuesri.three.WallLayer")],A);p.install=t=>{t.component(p.name,p)};export{p as V};
