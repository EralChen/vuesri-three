import{yc as ct,yd as ui,ye as di,yf as pi,yg as mi,yh as fi,cc as ut,cd as yi,bc as dt,bI as Pt,yi as hi,bR as Bt,w as vi,by as Ti,dv as wi,yj as Mi,yk as gi,yl as xi,U as $i,ym as bi,yn as Li,yo as Si,bP as Oi,a9 as De,j as _i,bb as Ci,bQ as Vi,oR as Ri,ad as Ei,yp as Wi,yq as ji,yr as Ii,ys as _t,yt as Hi,yu as Pi,yv as Bi}from"./chunk-C4bXDfxA.js";import{m as tt,a7 as ki}from"./chunk-D_yTKJJf.js";import{x as _,o as pt,d as m,$ as g,q as V,A,Q as h,z as ie,j as w,b as T,c as x,r as y,e as mt,k as $,L as ne,M as R,a as p,a0 as ft,a1 as yt,a2 as Ae,w as E,y as re,S as k,B as P,l as j,a3 as Xe,p as z,s as Ke,G as kt,H as At,a4 as Ai,a5 as Di,N as Dt,a6 as Gi,a7 as Gt,u as Ni,K as Fi,a8 as Ui,a9 as qi}from"./chunk-CDohQU0g.js";const W=Symbol("mitter"),Nt=Symbol("cursor"),F=Symbol("index"),lt=Symbol("index-topping"),Ct=(e,t)=>!(t.maxScale&&e<t.maxScale||t.minScale&&e>=t.minScale);class Ye{constructor(){this.removeHandler=null}async remove(){var t;await((t=this.removeHandler)==null?void 0:t.call(this)),this.removeHandler=null}async toggle(t){this.removeHandler?this.remove():this.add(t)}async reset(t){await this.remove(),await this.add(t)}}function X(){const e=_("vaView");if(!e)throw new Error("The component which use useView() must be in a View component");return e}function zi(){const e=_("vaSceneView");if(!e)throw new Error("The component which use useSceneView() must be in <VaSceneView>");return e}function Ft(){const e=_("vaLayer");if(!e)throw new Error("The component which use useLayer() must be in a Layer component");return e}function Xi(){const e=_("vaSublayers");if(!e)throw new Error("The component which use useSublayers() must be in a has Sublayers component");return e}var Ki=Object.defineProperty,Yi=(e,t,i)=>t in e?Ki(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Qi=(e,t,i)=>(Yi(e,typeof t!="symbol"?t+"":t,i),i);class Ji extends Ye{constructor(t){super(),Qi(this,"interceptor"),this.interceptor=t}add(){tt.request.interceptors||(tt.request.interceptors=[]),tt.request.interceptors?.unshift(this.interceptor)}}const Zi=e=>{const t=new Ji(e);return pt(()=>{t.remove()}),{interceptorToggle:t}};function M(){const e=_("vaView");if(!e)throw new Error("The component which use useView() must be in a View component");return e}function en(){const e=_("vaSceneView");if(!e)throw new Error("The component which use useSceneView() must be in <VaSceneView>");return e}function Ut(){const e=_("vaBasemap");if(!e)throw new Error("The component which use useBasemap() must be in <VaBasemap>");return e}function tn(){const e=_("vaBasemapToggle");if(!e)throw new Error("The component which use useBasemapToggle() must be in <VaBasemapToggle>");return e}function Qe(){const e=_("vaLayer");if(!e)throw new Error("The component which use useLayer() must be in a Layer component");return e}function nn(){const e=_("vaFeatureLayer");if(!e)throw new Error("The component which use useFeatureLayer() must be in a FeatureLayer component");return e}function rn(){const e=_("vaGraphicsLayer");if(!e)throw new Error("The component which use useGraphicsLayer() must be in a GraphicsLayer component");return e}function an(){const e=_("vaGraphic");if(!e)throw new Error("The component which use useGraphic() must be in a Graphic component");return e}function on(){const e=_("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const qt={cursor:{type:String,default:""}},zt={"update:cursor":e=>e||!0};var Xt=Object.freeze({__proto__:null,emits:zt,props:qt}),ln=typeof global=="object"&&global&&global.Object===Object&&global,sn=typeof self=="object"&&self&&self.Object===Object&&self,Kt=ln||sn||Function("return this")(),Ue=Kt.Symbol,Yt=Object.prototype,cn=Yt.hasOwnProperty,un=Yt.toString,se=Ue?Ue.toStringTag:void 0;function dn(e){var t=cn.call(e,se),i=e[se];try{e[se]=void 0;var n=!0}catch{}var r=un.call(e);return n&&(t?e[se]=i:delete e[se]),r}var pn=Object.prototype,mn=pn.toString;function fn(e){return mn.call(e)}var yn="[object Null]",hn="[object Undefined]",Vt=Ue?Ue.toStringTag:void 0;function vn(e){return e==null?e===void 0?hn:yn:Vt&&Vt in Object(e)?dn(e):fn(e)}function Tn(e){return e!=null&&typeof e=="object"}var wn="[object Symbol]";function Mn(e){return typeof e=="symbol"||Tn(e)&&vn(e)==wn}var gn=/\s/;function xn(e){for(var t=e.length;t--&&gn.test(e.charAt(t)););return t}var $n=/^\s+/;function bn(e){return e&&e.slice(0,xn(e)+1).replace($n,"")}function qe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Rt=NaN,Ln=/^[-+]0x[0-9a-f]+$/i,Sn=/^0b[01]+$/i,On=/^0o[0-7]+$/i,_n=parseInt;function Et(e){if(typeof e=="number")return e;if(Mn(e))return Rt;if(qe(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=qe(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=bn(e);var i=Sn.test(e);return i||On.test(e)?_n(e.slice(2),i?2:8):Ln.test(e)?Rt:+e}var it=function(){return Kt.Date.now()},Cn="Expected a function",Vn=Math.max,Rn=Math.min;function En(e,t,i){var n,r,a,o,s,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(Cn);t=Et(t)||0,qe(i)&&(d=!!i.leading,u="maxWait"in i,a=u?Vn(Et(i.maxWait)||0,t):a,f="trailing"in i?!!i.trailing:f);function b(S){var D=n,le=r;return n=r=void 0,c=S,o=e.apply(le,D),o}function O(S){return c=S,s=setTimeout(H,t),d?b(S):o}function L(S){var D=S-l,le=S-c,Ot=t-D;return u?Rn(Ot,a-le):Ot}function C(S){var D=S-l,le=S-c;return l===void 0||D>=t||D<0||u&&le>=a}function H(){var S=it();if(C(S))return oe(S);s=setTimeout(H,L(S))}function oe(S){return s=void 0,f&&n?b(S):(n=r=void 0,o)}function Y(){s!==void 0&&clearTimeout(s),c=0,n=l=r=s=void 0}function Q(){return s===void 0?o:oe(it())}function et(){var S=it(),D=C(S);if(n=arguments,r=this,l=S,D){if(s===void 0)return O(l);if(u)return clearTimeout(s),s=setTimeout(H,t),b(l)}return s===void 0&&(s=setTimeout(H,t)),o}return et.cancel=Y,et.flush=Q,et}var Wn="Expected a function";function st(e,t,i){var n=!0,r=!0;if(typeof e!="function")throw new TypeError(Wn);return qe(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),En(e,t,{leading:n,maxWait:t,trailing:r})}var jn=Object.defineProperty,In=(e,t,i)=>t in e?jn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nt=(e,t,i)=>(In(e,typeof t!="symbol"?t+"":t,i),i),ht=m({emits:zt,props:qt,setup(e,{emit:t}){const i=X();class n extends Ye{constructor(l,c){super(),nt(this,"eventName"),nt(this,"handler"),nt(this,"cacheData"),this.eventName=l,this.handler=c}add(){const l=i.on(this.eventName,this.handler);this.removeHandler=l.remove}}const r=i[W],a=new n("click",async s=>{const l=await i.hitTest(s);console.log("va_view_click_event",{view:i,event:s,hitTestResult:l}),r.emit("click",{view:i,event:s,hitTestResult:l})});a.add(),g(()=>{a.remove()});const o=new n("pointer-move",st(async s=>{const l=await i.hitTest(s),c=l.results[0];let d;if(c&&(c.type==="media"?d=c.layer:c.type==="graphic"&&(d=c.graphic?.layer)),d){const u=d[Nt];t("update:cursor",u)}else t("update:cursor","initial");r.emit("pointer-move",{view:i,event:s,hitTestResult:l})},600,{leading:!1,trailing:!0}));return o.add(),g(()=>{o.remove()}),()=>null}});ht.__file="view/src/events/index.vue";var Hn=Object.defineProperty,Pn=(e,t,i)=>t in e?Hn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,rt=(e,t,i)=>(Pn(e,typeof t!="symbol"?t+"":t,i),i),vt=m({setup(){const e=M();class t extends Ye{constructor(o,s){super(),rt(this,"propertyName"),rt(this,"handler"),rt(this,"cacheData"),this.propertyName=o,this.handler=s}add(){const o=e.watch(this.propertyName,this.handler);this.removeHandler=o.remove}}const i=e[W],n=new t("extent",st((a,o)=>{i.emit("watch:extent",[a,o])},50));n.add(),g(()=>{n.remove()});const r=new t("scale",st((a,o)=>{i.emit("watch:scale",[a,o])},50));return r.add(),g(()=>{r.remove()}),()=>null}});vt.__file="view/src/watchs/index.vue";function Bn(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(t,i)})}}}const kn={...Xt.props,defaultOptions:{type:Object,default:()=>({})},cursor:{type:String,default:""}},An={...Xt.emits,load:e=>e};var ce=m({name:"VaMapView",components:{ViewEvents:ht,ViewWatchs:vt},inheritAttrs:!1,props:kn,emits:An,setup(e,{emit:t}){const i=V(),n=new ct,r=new ui({map:n,...e.defaultOptions});r[W]=Bn(),r.ui.components=[],window.__VA_MAP_VIEW__=r;const a=V(""),o=A(()=>({"--va-map-view-cursor":e.cursor||a.value}));return h("vaView",r),h("vaMapView",r),ie(()=>{r.container=i.value,t("load",{view:r})}),{viewNode:i,eventCursor:a,cursorStyle:o}}});function Dn(e,t,i,n,r,a){const o=w("ViewEvents"),s=w("ViewWatchs");return T(),x(R,null,[y(e.$slots,"before"),mt("div",ne({ref:"viewNode",style:e.cursorStyle,class:"va-map-view va-view-x"},e.$attrs),[$(o,{cursor:e.eventCursor,"onUpdate:cursor":t[0]||(t[0]=l=>e.eventCursor=l)},null,8,["cursor"]),$(s),y(e.$slots,"default")],16),y(e.$slots,"after")],64)}ce.render=Dn;ce.__file="map-view/src/index.vue";ce.install=e=>{e.component(ce.name,ce)};function Je(e,t){p(()=>{e.visible=t.visible}),ft(()=>{e.visible=!1}),yt(()=>{e.visible=t.visible})}const Qt={maxScale:{type:Number,default:0},minScale:{type:Number,default:0},cursor:{type:String,default:""},title:{type:String,default:""},visible:{type:Boolean,default:!0},opacity:{type:Number,default:1},index:{type:Number,default:void 0},orphan:{type:Boolean,default:!1}},Gn=Ae(Qt);var I=Object.freeze({__proto__:null,createBindProps:Gn,props:Qt}),Nn=Object.defineProperty,Fn=(e,t,i)=>t in e?Nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Un=(e,t,i)=>(Fn(e,typeof t!="symbol"?t+"":t,i),i);function qn(e,t,i){const n=()=>e instanceof ct?e.layers:e;if(i.orphan)return;t[F]=i.index,t[lt]=i.indexTopping,e.add(t);const r=()=>{const a=n();Xn(a).forEach((s,l)=>{setTimeout(()=>{e.reorder(s,l)})})};t.when(()=>{r()}),typeof i.index=="number"&&r(),E(()=>[i.index,i.indexTopping],([a,o])=>{typeof a=="number"&&(t[F]=a,t[lt]=o,r())}),g(()=>{e.remove(t)})}function zn(e,t){Je(e,t),p(()=>{e[Nt]=t.cursor}),p(()=>{e.title=t.title}),p(()=>{e.maxScale=t.maxScale}),p(()=>{e.minScale=t.minScale}),p(()=>{e.opacity=t.opacity})}function Xn(e){const t=new Wt,i=new Wt;return e.forEach(n=>{const r=n[F];n[lt]?i.add(n,r):t.add(n,r)}),[...t.toArray(),...i.toArray()]}class Wt{constructor(){Un(this,"record",{})}add(t,i){if(typeof i=="number"){let n=this.record[i];for(;n;)i++,n=this.record[i];this.record[i]=t}else this.record[this.getMaxIndex()+1]=t}getMaxIndex(){const t=Object.keys(this.record);return t.length?Math.max(...t.map(Number)):0}toArray(){return Object.values(this.record)}}var v=Object.freeze({__proto__:null,useAddLayer:qn,useSetLayerOptions:zn}),Kn=Object.defineProperty,Yn=(e,t,i)=>t in e?Kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,at=(e,t,i)=>(Yn(e,typeof t!="symbol"?t+"":t,i),i);const Be=e=>class extends Ye{constructor(t,i){super(),at(this,"name"),at(this,"handler"),at(this,"cacheData"),this.name=t,this.handler=i}add(){e.on(this.name,this.handler),this.removeHandler=()=>e.off(this.name,this.handler)}},Tt={click:e=>e,pointerMove:e=>e},Qn=re(Tt);var ae=Object.freeze({__proto__:null,createOnEmits:Qn,emits:Tt}),B=m({emits:Tt,setup(e,{emit:t}){const i=M(),n=Qe(),r=i[W],a=Be(r),o=new a("click",l=>{const{hitTestResult:c}=l,u=c.results.find(f=>f.type==="media"?f.layer===n:f.graphic?.layer===n);t("click",{...l,result:u,layer:n})});o.add(),g(()=>{o.remove()});const s=new a("pointer-move",l=>{const{hitTestResult:c}=l,u=c.results.find(f=>f.type==="media"?f.layer===n:f.graphic?.layer===n);t("pointerMove",{...l,result:u,layer:n})});return s.add(),g(()=>{s.remove()}),()=>null}});B.__file="layer-hit-events/src/index.vue";B.install=e=>{e.component(B.name,B)};const Jn={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:"",required:!0},geometryType:{type:String,required:!0,default:""},definitionExpression:{type:String,default:"1=1"},renderer:{type:Object,default:void 0}},Zn={load:e=>e,click:e=>e,pointerMove:e=>e};function er(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(t,i)})}}}var ue=m({name:"VaGeojsonLayer",components:{VaLayerHitEvents:B},props:Jn,emits:Zn,setup(e,{emit:t}){const i=M(),n=i.map,r=ae.createOnEmits(t),a=new di({...e.defaultOptions});return a[W]=er(),v.useSetLayerOptions(a,e),p(()=>{a.geometryType=e.geometryType}),p(()=>{a.url=e.url,a.refresh()}),p(()=>{e.renderer!==void 0&&(a.renderer=e.renderer)}),p(()=>{a.definitionExpression=e.definitionExpression}),v.useAddLayer(n,a,e),t("load",{view:i,layer:a}),h("vaLayer",a),h("vaGeojsonLayer",a),{layerEventsOnEmits:r}}});function tr(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.layerEventsOnEmits),null,16),y(e.$slots,"default")],64)}ue.render=tr;ue.__file="geojson-layer/src/index.vue";ue.install=e=>{e.component(ue.name,ue)};const ir={baseLayers:{type:Array,default:()=>[]},spatialReference:{type:Object,default:void 0},orphan:{type:Boolean,default:!1},defaultOptions:{type:Object,default:()=>({})},thumbnailUrl:{type:String,default:""}},nr={load:e=>e};var de=m({name:"VaBasemap",props:ir,emits:nr,setup(e,{emit:t,slots:i}){const n=M(),r=n.map,a=r.basemap,o=new pi({...e.defaultOptions});return p(()=>{o.baseLayers=e.baseLayers}),p(()=>{o.spatialReference=e.spatialReference||n.spatialReference}),p(()=>{o.thumbnailUrl=e.thumbnailUrl}),!e.orphan&&(r.basemap=o),g(()=>{r.basemap===o&&(r.basemap=a)}),h("vaBasemap",o),t("load",{view:n,basemap:o}),()=>i.default?.()}});de.__file="basemap/src/index.vue";de.install=e=>{e.component(de.name,de)};const Jt={position:{type:[String,Object],default:"manual"},orphan:{type:Boolean,default:!1}},Zt={load:e=>e};var ei=Object.freeze({__proto__:null,emits:Zt,props:Jt});const ti=(e,t,i)=>{i.orphan||(p(()=>{e.add(t,i.position)}),pt(()=>{e.remove(t)}),yt(()=>{e.add(t,i.position)}),ft(()=>{e.remove(t)}))};var Ze=Object.freeze({__proto__:null,useAddUi:ti}),U=m({name:"VaViewUi",emits:Zt,props:Jt,setup(e,{emit:t}){const i=M(),n=V(),r=V(!1);return ie(()=>{n.value&&(ti(i.ui,n.value,e),r.value=!0,h("vaViewUi",n.value),t("load",{view:i,el:n.value}))}),{viewUiNode:n,ready:r}}});const rr={ref:"viewUiNode",class:"va-view-ui"};function ar(e,t,i,n,r,a){return T(),x("div",rr,[e.ready?y(e.$slots,"default",{key:0}):P("v-if",!0)],512)}U.render=ar;U.__file="view-ui/src/index.vue";U.install=e=>{e.component(U.name,U)};const or={defaultOptions:{type:Object,default:()=>({})},position:{type:[String,Object],default:"bottom-right"},visible:{type:Boolean,default:!0}},lr={load:e=>e};var pe=m({name:"VaBasemapToggle",emits:lr,props:or,setup(e,{emit:t}){const i=M(),n=V(),r=new mi({view:i,...e.defaultOptions});return Je(r,e),h("vaBasemapToggle",r),ie(()=>{r.container=n.value,Ze.useAddUi(i.ui,r,e),t("load",{view:i,basemapToggle:r})}),{toggleNode:n}}});const sr={ref:"toggleNode"};function cr(e,t,i,n,r,a){return T(),x("div",sr,[y(e.$slots,"default")],512)}pe.render=cr;pe.__file="basemap-toggle/src/index.vue";pe.install=e=>{e.component(pe.name,pe)};var me=m({name:"VaBasemapBaseLayers",setup(){const e=Ut(),t=Qe();return v.useAddLayer(e.baseLayers,t,{}),()=>null}});me.__file="basemap-base-layers/src/index.vue";me.install=e=>{e.component(me.name,me)};var Ge=m({name:"VaBasemapToggleNextBasemap",setup(){const e=Ut(),t=tn(),i=t.nextBasemap;return t.nextBasemap=e,g(()=>{t.nextBasemap===e&&(t.nextBasemap=i)}),()=>null}});Ge.__file="basemap-toggle-next-basemap/src/index.vue";Ge.install=e=>{e.component(Ge.name,Ge)};var q=m({name:"VaSublayersProvider",setup(){const e=Ft();return h("vaSublayers",e.sublayers),{}}});function ur(e,t,i,n,r,a){return y(e.$slots,"default")}q.render=ur;q.__file="sublayers-provider/src/index.vue";q.install=e=>{e.component(q.name,q)};const dr={layer:{type:Object,default:void 0}},pr={load:e=>e};var G=m({name:"VaLayerWhen",props:dr,emits:pr,setup(e,{emit:t}){const i=M(),n=e.layer||Qe(),r=V(!1);return n.when().then(()=>{r.value=!0,t("load",{view:i,layer:n})}),{ready:r,view:i,layer:n}}});function mr(e,t,i,n,r,a){return e.ready?y(e.$slots,"default",{key:0,view:e.view,layer:e.layer}):P("v-if",!0)}G.render=mr;G.__file="layer-when/src/index.vue";G.install=e=>{e.component(G.name,G)};const fr={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""}},yr={load:e=>e};var fe=m({name:"VaTileLayer",components:{VaLayerWhen:G,VaSublayersProvider:q},emits:yr,props:fr,setup(e,{emit:t}){const i=M(),n=i.map,r=new fi({...e.defaultOptions});return p(()=>{r.url=e.url}),v.useSetLayerOptions(r,e),v.useAddLayer(n,r,e),h("vaLayer",r),h("vaTileLayer",r),t("load",{view:i,layer:r}),{}}});function hr(e,t,i,n,r,a){const o=w("VaSublayersProvider"),s=w("VaLayerWhen");return T(),x(R,null,[y(e.$slots,"default"),$(s,null,{default:j(()=>[$(o,null,{default:j(()=>[y(e.$slots,"when")]),_:3})]),_:3})],64)}fe.render=hr;fe.__file="tile-layer/src/index.vue";fe.install=e=>{e.component(fe.name,fe)};const wt=[{level:0,levelValue:"0",resolution:1.4062500262315807,scale:590995197141669e-6},{level:1,levelValue:"1",resolution:.7031250131157915,scale:295497598570835e-6},{level:2,levelValue:"2",resolution:.3515625065578945,scale:147748799285417e-6},{level:3,levelValue:"3",resolution:.1757812532789475,scale:738743996427086e-7},{level:4,levelValue:"4",resolution:.08789062663947375,scale:369371998213543e-7},{level:5,levelValue:"5",resolution:.043945313319736994,scale:184685999106772e-7},{level:6,levelValue:"6",resolution:.02197265665986845,scale:923429995533858e-8},{level:7,levelValue:"7",resolution:.010986328329934226,scale:461714997766929e-8},{level:8,levelValue:"8",resolution:.005493164164967124,scale:230857498883465e-8},{level:9,levelValue:"9",resolution:.0027465820824835504,scale:115428749441732e-8},{level:10,levelValue:"10",resolution:.0013732910412417776,scale:577143.747208661},{level:11,levelValue:"11",resolution:.0006866455206208899,scale:288571.873604331},{level:12,levelValue:"12",resolution:.0003433227603104438,scale:144285.936802165},{level:13,levelValue:"13",resolution:.0001716613801552224,scale:72142.9684010827},{level:14,levelValue:"14",resolution:8583069007761132e-20,scale:36071.4842005414},{level:15,levelValue:"15",resolution:4291534503880566e-20,scale:18035.7421002707},{level:16,levelValue:"16",resolution:21457672519402802e-21,scale:9017.87105013534},{level:17,levelValue:"17",resolution:10728836259701401e-21,scale:4508.93552506767},{level:18,levelValue:"18",resolution:5364418129850712e-21,scale:2254.46776253384},{level:19,levelValue:"19",resolution:2682209064925356e-21,scale:1127.23388126692},{level:20,levelValue:"20",resolution:13411045321451153e-22,scale:563.6169405}],ii={x:-180,y:90},ke=wt.reduce((e,t)=>(e[t.level]=t.scale,e),{}),vr={xmin:-180,ymin:-90,xmax:180,ymax:90},Tr=new ut({size:[256,256],origin:ii,lods:wt}),jt=Object.freeze(Object.defineProperty({__proto__:null,fullExtent:vr,levelToScale:ke,lods:wt,origin:ii,tileInfo:Tr},Symbol.toStringTag,{value:"Module"})),Mt={...I.props,defaultOptions:{type:Object,default:()=>({})}},wr=Ae(Mt),gt={load:e=>e},Mr=re(gt);var ze=Object.freeze({__proto__:null,createBindProps:wr,createOnEmits:Mr,emits:gt,props:Mt}),ye=m({name:"VaWebTileLayer",emits:gt,props:Mt,setup(e,{emit:t,slots:i}){const n=M(),r=n.map,a=new yi({...e.defaultOptions});return v.useSetLayerOptions(a,e),v.useAddLayer(r,a,e),h("vaWebTileLayer",a),h("vaLayer",a),t("load",{view:n,layer:a}),()=>i.default?.()}});ye.__file="web-tile-layer/src/index.vue";ye.install=e=>{e.component(ye.name,ye)};const xt=[{level:0,resolution:156543.033928,scale:591657527591555e-6},{level:1,resolution:78271.5169639999,scale:295828763795777e-6},{level:2,resolution:39135.7584820001,scale:147914381897889e-6},{level:3,resolution:19567.8792409999,scale:73957190948944e-6},{level:4,resolution:9783.93962049996,scale:36978595474472e-6},{level:5,resolution:4891.96981024998,scale:18489297737236e-6},{level:6,resolution:2445.98490512499,scale:9244648868618e-6},{level:7,resolution:1222.99245256249,scale:4622324434309e-6},{level:8,resolution:611.49622628138,scale:2311162217155e-6},{level:9,resolution:305.748113140558,scale:1155581108577e-6},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}],gr={x:-20037508342787e-6,y:20037508342787e-6},xr=xt.reduce((e,t)=>(e[t.level]=t.scale,e),{}),$r={xmin:-20037508342787e-6,ymin:-2003750834278e-5,xmax:2003750834278e-5,ymax:20037508342787e-6},br=new ut({dpi:96,origin:{spatialReference:{wkid:3857},x:-20037508342787e-6,y:20037508342787e-6},lods:xt,size:[256,256],spatialReference:{wkid:3857}}),ot=Object.freeze(Object.defineProperty({__proto__:null,fullExtent:$r,levelToScale:xr,lods:xt,origin:gr,tileInfo:br},Symbol.toStringTag,{value:"Module"})),Lr={...ze.props,type:{type:String,default:"img_c"},spatialReference:{type:Object,default:()=>({wkid:4326})},token:{type:String,default:"f0175927031c1e12cb804b0c3b8cce4d"},minScale:{type:Number,default:ke[1]},maxScale:{type:Number,default:ke[18]}},Sr={...ze.emits},Or={4326:jt,4490:jt,3857:ot,102100:ot,4549:ot};var J=m({name:"VaTdtWebTileLayer",components:{VaWebTileLayer:ye},props:Lr,emits:Sr,setup(e,{emit:t}){const i=["t0","t1","t2","t3","t4","t5","t6","t7"],n=A(()=>{const l=e.type.split("_"),c=l[0],d=l[1];return{baseLayer:c,typeSR:d}}),r=A(()=>{const l=e.spatialReference.wkid,c=Or[l],d={origin:c.origin,spatialReference:e.spatialReference};d.lods=c.lods.slice(1,19);const u={subDomains:i,urlTemplate:`https://{subDomain}.tianditu.gov.cn/${e.type}/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=${n.value.baseLayer}&STYLE=default&TILEMATRIXSET=${n.value.typeSR}&FORMAT=tiles&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}&tk=${e.token}`,tileInfo:d,spatialReference:e.spatialReference,...e.defaultOptions};return c.fullExtent&&(u.fullExtent=new dt({...c.fullExtent,spatialReference:e.spatialReference})),u}),a=ze.createBindProps(e,["defaultOptions"]),o=ze.createOnEmits(t),s=V(!0);return E(()=>e.type,async()=>{s.value=!1,await Xe(),s.value=!0}),{defaultOptions:r,coreProps:a,coreEmits:o,ready:s}}});function _r(e,t,i,n,r,a){const o=w("VaWebTileLayer");return e.ready?(T(),z(o,ne({key:0,"default-options":e.defaultOptions},e.coreProps,k(e.coreEmits)),{default:j(()=>[y(e.$slots,"default")]),_:3},16,["default-options"])):P("v-if",!0)}J.render=_r;J.__file="tdt-web-tile-layer/src/index.vue";J.install=e=>{e.component(J.name,J)};const Cr={spatialReference:{type:Object,default:()=>({wkid:4326})},type:{type:String,default:"img_c"},orphan:{type:Boolean,default:!1},anno:{type:Boolean,default:!0},thumbnailUrl:{type:String,default:""},minScale:{type:Number,default:ke[1]},maxScale:{type:Number,default:ke[18]},token:{type:String,default:void 0},webTileLayerOptions:{type:Object,default:()=>({})}},Vr={load:e=>e};var N=m({name:"VaTdtBasemap",components:{VaBasemap:de,VaBasemapBaseLayers:me,VaTdtWebTileLayer:J},props:Cr,emits:Vr,setup(e){const t=A(()=>{const n=e.type.split("_"),r=n[0],a=n[1];return`c${r[0]}a_${a}`});return{thumbnailUrl:A(()=>e.thumbnailUrl?e.thumbnailUrl:e.type.startsWith("vec")?"http://lbs.tianditu.gov.cn/images/vec_c.png":e.type.startsWith("img")?"http://lbs.tianditu.gov.cn/images/img_c.png":""),annoType:t}}});function Rr(e,t,i,n,r,a){const o=w("VaBasemapBaseLayers"),s=w("VaTdtWebTileLayer"),l=w("VaBasemap");return T(),z(l,{orphan:e.orphan,"thumbnail-url":e.thumbnailUrl,onLoad:t[0]||(t[0]=c=>e.$emit("load",c))},{default:j(()=>[P(" layer "),$(s,{"default-options":e.webTileLayerOptions,type:e.type,orphan:!0,"spatial-reference":e.spatialReference,"max-scale":e.maxScale,"min-scale":e.minScale,token:e.token,title:"tdt_web_tile_layer"},{default:j(()=>[$(o)]),_:1},8,["default-options","type","spatial-reference","max-scale","min-scale","token"]),P(" anno "),e.anno?(T(),z(s,{key:0,type:e.annoType,orphan:!0,"spatial-reference":e.spatialReference,"max-scale":e.maxScale,"min-scale":e.minScale,token:e.token,"default-options":e.webTileLayerOptions,title:"tdt_web_tile_layer_anno"},{default:j(()=>[$(o)]),_:1},8,["type","spatial-reference","max-scale","min-scale","token","default-options"])):P("v-if",!0),y(e.$slots,"default")]),_:3},8,["orphan","thumbnail-url"])}N.render=Rr;N.__file="tdt-basemap/src/index.vue";N.install=e=>{e.component(N.name,N)};N.install=e=>{e.component(N.name,N)};function Er(e,t){v.useSetLayerOptions(e,t),p(()=>{t.renderer!==void 0&&(e.renderer=t.renderer)}),p(()=>{e.definitionExpression=t.definitionExpression}),p(()=>{e.popupEnabled=t.popupEnabled})}function Wr(e,t,i){p(()=>{e.when(()=>{t.spatialReference=i.spatialReference||e.spatialReference})})}var te=Object.freeze({__proto__:null,useSetLayerOptions:Er,useSetLayerSpatialReference:Wr});const ni={...I.props,renderer:{type:Object,default:void 0},definitionExpression:{type:String,default:"1=1"},popupEnabled:{type:Boolean,default:!0},defaultOptions:{type:Object,default:()=>({})},spatialReference:{type:Object,default:void 0}},jr=Ae(ni),ri={click:e=>e,pointerMove:e=>e},Ir=re(ri);var K=Object.freeze({__proto__:null,createBindProps:jr,createOnEmits:Ir,emits:ri,props:ni});const Hr={...K.props,url:{type:String,default:"",require:!0},layerId:{type:Number,default:void 0}},Pr={...K.emits,load:e=>e};function Br(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(t,i)})}}}var he=m({name:"VaServerFeatureLayer",components:{VaLayerHitEvents:B},props:Hr,emits:Pr,setup(e,{emit:t}){const i=M(),n=i.map,r=ae.createOnEmits(t),a=new Pt({...e.defaultOptions});return a[W]=Br(),p(()=>{a.url=e.url}),p(()=>{e.layerId&&(a.layerId=e.layerId)}),te.useSetLayerOptions(a,e),te.useSetLayerSpatialReference(i,a,e),v.useAddLayer(n,a,e),h("vaLayer",a),h("vaFeatureLayer",a),t("load",{view:i,layer:a}),{hitEmits:r}}});function kr(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.hitEmits),null,16),y(e.$slots,"default")],64)}he.render=kr;he.__file="server-feature-layer/src/index.vue";he.install=e=>{e.component(he.name,he)};const Ar={load:e=>e};var ve=m({name:"VaViewWhen",emits:Ar,setup(e,{emit:t}){const i=M(),n=V(!1);i.when().then(()=>{n.value=!0,t("load",{view:i})});function r(a){return i.map.layers.find(o=>o.title===a)}return{ready:n,view:i,getLayerByTitle:r}}});function Dr(e,t,i,n,r,a){return e.ready?y(e.$slots,"default",{key:0,view:e.view,spatialReference:e.view.spatialReference,map:e.view.map,layers:e.view.map.layers,getLayerByTitle:e.getLayerByTitle}):P("v-if",!0)}ve.render=Dr;ve.__file="view-when/src/index.vue";ve.install=e=>{e.component(ve.name,ve)};const Gr={defaultOptions:{type:Object,default:()=>({})},cursor:{type:String,default:""}},Nr={load:e=>e};function Fr(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(t,i)})}}}var Te=m({name:"VaSceneView",components:{ViewEvents:ht,ViewWatchs:vt},inheritAttrs:!1,props:Gr,emits:Nr,setup(e,{emit:t}){const i=V(),n=new ct,r=new hi({map:n,...e.defaultOptions});r[W]=Fr(),r.ui.components=[],window.__VA_SCENE_VIEW__=r;const a=V(""),o=A(()=>({"--va-scene-view-cursor":e.cursor||a.value}));return h("vaView",r),h("vaSceneView",r),ie(()=>{r.container=i.value,t("load",{view:r})}),{viewNode:i,eventCursor:a,cursorStyle:o}}});function Ur(e,t,i,n,r,a){const o=w("ViewEvents"),s=w("ViewWatchs");return T(),x(R,null,[y(e.$slots,"before"),mt("div",ne({ref:"viewNode",style:e.cursorStyle,class:"va-scene-view va-view-x"},e.$attrs),[$(o,{cursor:e.eventCursor,"onUpdate:cursor":t[0]||(t[0]=l=>e.eventCursor=l)},null,8,["cursor"]),$(s),y(e.$slots,"default")],16),y(e.$slots,"after")],64)}Te.render=Ur;Te.__file="scene-view/src/index.vue";Te.install=e=>{e.component(Te.name,Te)};const ai={...K.props,source:{type:[Object,Array],required:!0,default:()=>[]},fields:{type:Array,required:!0,default:()=>[]},geometryType:{type:String,default:"point",required:!0},objectIdField:{type:String,default:"ObjectID"},forceUpdate:{type:Boolean,default:!1}},$t={...K.emits,change:e=>e,load:e=>e},qr=re($t);var oi=Object.freeze({__proto__:null,createOnEmits:qr,emits:$t,props:ai});function zr(e){return{all:e=e||new Map,on:function(t,i){var n=e.get(t);n?n.push(i):e.set(t,[i])},off:function(t,i){var n=e.get(t);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var n=e.get(t);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(t,i)})}}}var Z=m({name:"VaClientFeatureLayer",components:{VaLayerHitEvents:B},emits:$t,props:ai,setup(e,{emit:t}){const i=M(),n=i.map,r=ae.createOnEmits(t),a=new Pt({source:e.source,...e.defaultOptions});a[W]=zr();const o=a[W];return te.useSetLayerOptions(a,e),te.useSetLayerSpatialReference(i,a,e),p(()=>{a.geometryType=e.geometryType}),p(()=>{a.objectIdField=e.objectIdField}),p(()=>{a.fields=e.fields}),v.useAddLayer(n,a,e),E(()=>e.source,(s,l)=>{Xe().then(()=>{const c=[],d=s.reduce((O,L)=>{const C=L.attributes[e.objectIdField];return O[C]=L,O},{}),u=l.reduce((O,L)=>{const C=L.attributes[e.objectIdField];return Reflect.has(d,C)?(c.push(L),Reflect.deleteProperty(d,C)):O[C]=L,O},{}),f=[],b=[];for(const O in d)f.push(d[O]);for(const O in u)b.push(u[O]);return{addFeatures:f,deleteFeatures:b,updateFeatures:c}}).then(c=>a.applyEdits(c)).then(()=>(e.forceUpdate&&(a.visible=!1,a.visible=!0),{view:i,layer:a})).then(c=>{o.emit("change",c),t("change",c)})}),h("vaLayer",a),h("vaFeatureLayer",a),t("load",{view:i,layer:a}),{hitEmits:r}}});function Xr(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.hitEmits),null,16),y(e.$slots,"default")],64)}Z.render=Xr;Z.__file="client-feature-layer/src/index.vue";Z.install=e=>{e.component(Z.name,Z)};const Kr={...K.props,query:{type:Object,default:void 0}},Yr={...oi.emits};var we=m({name:"VaDerivedFeatureLayer",components:{VaClientFeatureLayer:Z,VaLayerWhen:G},emits:Yr,props:Kr,setup(e,{emit:t}){const i=nn(),n=K.createBindProps(e,["renderer"]),r=oi.createOnEmits(t),a=Ke([]);return E(()=>e.query&&{...e.query},o=>{o?i.queryFeatures({where:"1=1",returnGeometry:!0,outFields:["*"],outSpatialReference:i.spatialReference,...o}).then(s=>{a.value=s.features}):a.value=[]},{immediate:!0}),{source:a,featureLayerProps:n,clientFeatureLayerOnEmit:r}}});function Qr(e,t,i,n,r,a){const o=w("VaClientFeatureLayer"),s=w("VaLayerWhen");return T(),z(s,null,{default:j(({layer:l})=>[$(o,ne({"object-id-field":l.objectIdField,"geometry-type":l.geometryType,fields:l.fields,source:e.source,renderer:e.renderer||l.renderer},e.featureLayerProps,k(e.clientFeatureLayerOnEmit)),{default:j(()=>[y(e.$slots,"default")]),_:2},1040,["object-id-field","geometry-type","fields","source","renderer"])]),_:3})}we.render=Qr;we.__file="derived-feature-layer/src/index.vue";we.install=e=>{e.component(we.name,we)};const Jr={...I.props,defaultOptions:{type:Object,default:()=>({})},graphics:{type:[Array,Object],default:()=>[]}},Zr={click:e=>e,pointerMove:e=>e,load:e=>e};var Me=m({name:"VaGraphicsLayer",components:{VaLayerHitEvents:B},emits:Zr,props:Jr,setup(e,{emit:t}){const i=M(),n=i.map,r=ae.createOnEmits(t),a=new Bt({...e.defaultOptions});return p(()=>{a.graphics=e.graphics}),v.useSetLayerOptions(a,e),v.useAddLayer(n,a,e),h("vaLayer",a),h("vaGraphicsLayer",a),t("load",{view:i,layer:a}),{eventsOnEmits:r}}});function ea(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.eventsOnEmits),null,16),y(e.$slots,"default")],64)}Me.render=ea;Me.__file="graphics-layer/src/index.vue";Me.install=e=>{e.component(Me.name,Me)};const bt={click:e=>e},ta=re(bt);var li=Object.freeze({__proto__:null,createOnEmits:ta,emits:bt}),ge=m({emits:bt,setup(e,{emit:t}){const i=M(),n=an(),r=i[W],a=Be(r),o=new a("click",s=>{const{hitTestResult:l}=s,c=l.results;let d;c[0]?.graphic===n&&(d=c[0]),t("click",{...s,result:d,graphic:n})});return o.add(),g(()=>{o.remove()}),()=>null}});ge.__file="graphic-hit-events/src/index.vue";ge.install=e=>{e.component(ge.name,ge)};const ia={defaultOptions:{type:Object,default:()=>({})},geometry:{type:Object,default:null},symbol:{type:Object,default:()=>({type:"simple-marker",color:[226,119,40]})},attributes:{type:Object,default:()=>({})},visible:{type:Boolean,default:!0},spatialReference:{type:Object,default:void 0},index:{type:Number,default:void 0},orphan:{type:Boolean,default:!1}},na={...li.emits,load:e=>e};function ra(e,t,i){if(i.orphan)return;t[F]=i.index,e.add(t,i.index);const n=r=>{e.forEach(a=>{a[F]>r&&setTimeout(()=>{e.reorder(a,a[F])})})};typeof i.index=="number"&&n(i.index),E(()=>i.index,r=>{typeof r=="number"&&(t[F]=i.index,e.reorder(t,r),n(r))}),g(()=>{e.remove(t)})}var xe=m({name:"VaGraphic",components:{VaGraphicHitEvents:ge},emits:na,props:ia,setup(e,{emit:t}){const i=M(),r=_("vaGraphicsLayer",null)?.graphics||i.graphics,a=li.createOnEmits(t),o=new vi({...e.defaultOptions});return Je(o,e),p(()=>{const s=e.geometry?.spatialReference;o.geometry=e.geometry,!s&&o.geometry&&i.when(()=>{o.geometry.spatialReference=e.spatialReference||i.spatialReference})}),p(()=>{o.attributes=e.attributes}),p(()=>{e.symbol&&(o.symbol=e.symbol)}),ra(r,o,e),h("vaGraphic",o),t("load",{view:i,graphic:o}),{eventsOnEmits:a,graphic:o}}});function aa(e,t,i,n,r,a){const o=w("VaGraphicHitEvents");return T(),x(R,null,[$(o,k(e.eventsOnEmits),null,16),y(e.$slots,"default",{graphic:e.graphic,geometry:e.graphic.geometry,attributes:e.graphic.attributes})],64)}xe.render=aa;xe.__file="graphic/src/index.vue";xe.install=e=>{e.component(xe.name,xe)};const oa={geometry:{type:Object,default:void 0},visible:{type:Boolean,default:!0},outContainsShow:{type:Boolean,default:!1},position:{type:[String,Object],default:"manual"},orphan:{type:Boolean,default:!1}},la={};var ee=m({name:"VaGeoViewUi",components:{VaViewUi:U},emits:la,props:oa,setup(e){const t=M(),i=t[W],n=Be(i),r={point(u){return u},extent(u){return u.center},mesh(u){return u.extent.center},multipoint(u){return u.extent.center},polygon(u){return u.extent.center},polyline(u){return u.extent.center}},a=A(()=>e.geometry?.type&&r[e.geometry.type](e.geometry)),o=V(!0),s=Ke(),l=()=>{let u=a.value?t.toScreen(a.value):{x:0,y:0};s.value=u};l();const c=new n("watch:extent",([u])=>{if(e.visible&&a.value){if(!e.outContainsShow&&!u.contains(a.value))return o.value=!1;l(),o.value=!0}});c.add(),g(()=>{c.remove()}),E(()=>a.value,()=>{l()});const d=A(()=>e.visible?o.value:!1);return{screenPoint:s,visible:d,setScreenPoint:l}}});function sa(e,t,i,n,r,a){const o=w("VaViewUi");return kt((T(),z(o,{class:"va-geo-view-ui",style:Ai({left:e.screenPoint?.x+"px",top:e.screenPoint?.y+"px"}),position:e.position,orphan:e.orphan},{default:j(()=>[y(e.$slots,"default")]),_:3},8,["style","position","orphan"])),[[At,e.visible]])}ee.render=sa;ee.__file="geo-view-ui/src/index.vue";ee.install=e=>{e.component(ee.name,ee)};const ca={defaultOptions:{type:Object,default:()=>({})},title:{type:[String,Function,Promise],default:""},orphan:{type:Boolean,default:!1}},ua={load:e=>e};var $e=m({name:"VaPopupTemplate",props:ca,emits:ua,setup(e,{emit:t}){const i=M(),n=_("vaSublayer",null)||_("vaLayer",null),r=n?.popupTemplate,a=V(new Map),o=new Ti({outFields:["*"],async content(l){const c=l.graphic.attributes;return Di(l.graphic),a.value.set(l.graphic,{el:null,attributes:c}),await Xe(),a.value.get(l.graphic)?.el},...e.defaultOptions});p(()=>{o.title=e.title}),n&&!e.orphan&&(n.popupTemplate=o),g(()=>{n&&(n.popupTemplate=r)});const s=wi(()=>i.popup.visible,l=>{l||a.value.clear()});return g(()=>{s.remove()}),t("load",{view:i,popupTemplate:o}),h("vaPopupTemplate",o),{graphicToNode:a,setRef:(l,c)=>l.el=c}}});function da(e,t,i,n,r,a){return T(),x(R,null,[kt(mt("div",null,[P(" key为func(), 节点会更新 ? "),(T(!0),x(R,null,Dt(e.graphicToNode.entries(),([o,s])=>(T(),x("div",{key:o.getObjectId(),ref_for:!0,ref:l=>e.setRef(s,l)},[y(e.$slots,"default",{attributes:s.attributes,geometry:o.geometry,graphic:o})]))),128))],512),[[At,!1]]),y(e.$slots,"plugins"),y(e.$slots,"extends")],64)}$e.render=da;$e.__file="popup-template/src/index.vue";$e.install=e=>{e.component($e.name,$e)};const pa={query:{type:Object,default:{}},visible:{type:Boolean,default:void 0},maxScale:{type:Number,default:0},minScale:{type:Number,default:0},queryExtent:{type:Boolean,default:!1}},ma={"update:visible":e=>typeof e=="boolean",load:e=>e,change:e=>e};function fa(e){return typeof e=="function"?e():Ni(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const It=()=>{};function ya(e,t){function i(...n){return new Promise((r,a)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(r).catch(a)})}return i}const ha=e=>e();function va(e,t=!0,i=!0,n=!1){let r=0,a,o=!0,s=It,l;const c=()=>{a&&(clearTimeout(a),a=void 0,s(),s=It)};return u=>{const f=fa(e),b=Date.now()-r,O=()=>l=u();return c(),f<=0?(r=Date.now(),O()):(b>f&&(i||!o)?(r=Date.now(),O()):t&&(l=new Promise((L,C)=>{s=n?C:L,a=setTimeout(()=>{r=Date.now(),o=!0,L(O()),c()},Math.max(0,f-b))})),!i&&!a&&(a=setTimeout(()=>o=!0,f)),o=!1,l)}}function Ta(e,t,i={}){const{eventFilter:n=ha,...r}=i;return E(e,ya(n,t),r)}function wa(e,t,i={}){const{throttle:n=0,trailing:r=!0,leading:a=!0,...o}=i;return Ta(e,t,{...o,eventFilter:va(n,r,a)})}const Ht=Symbol("key");var be=m({name:"VaFeaturePopupLayer",components:{VaGeoViewUi:ee,VaViewUi:U},inheritAttrs:!1,props:pa,emits:ma,setup(e,{emit:t}){const i=M(),n=Qe(),r=Be(i[W]),a=Gi({default:Ct(i.scale,{maxScale:e.maxScale,minScale:e.minScale}),key:"visible"},e,t),o=Ke([]),s=Gt({}),l=async()=>{if(a.value)return await i.when(),n.queryFeatures({returnGeometry:!0,outFields:["*"],where:"1=1",geometry:s.current,outSpatialReference:i.spatialReference,...e.query}).then(u=>(o.value=u.features.map(f=>(f[Ht]=f.attributes[n.objectIdField],f)),s.queried=s.current,u))};l().then(u=>{t("load",{featureSet:u,view:i,layer:n})}),E(()=>a.value,u=>{u&&(s.current=s.view,l())}),E(()=>({geometry:s.current,...e.query}),async()=>{await l().then(u=>{t("change",{featureSet:u,view:i,layer:n})})}),wa(()=>s.view,async u=>{if(u&&a.value){if(!s.queried){s.current=u;return}s.queried.contains(u)||(s.current=s.queried.union(u).clone())}},{throttle:1e3});const c=new r("watch:scale",([u])=>{a.value=Ct(u,{maxScale:e.maxScale,minScale:e.minScale})});c.add(),g(()=>{c.remove()});const d=new r("watch:extent",([u])=>{s.view=u});if(E(()=>e.queryExtent,()=>{e.queryExtent?d.add():d.remove()},{immediate:!0}),g(()=>{d.remove()}),n[W]){const u=Be(n[W]),f=new u("change",async()=>{o.value=[],await Xe(),await l()});f.add(),g(()=>{f.remove()})}return{visible:a,features:o,layer:n,sKey:Ht}}});function Ma(e,t,i,n,r,a){const o=w("VaGeoViewUi"),s=w("VaViewUi");return T(),z(s,{class:"feature-popup-layer"},{default:j(()=>[(T(!0),x(R,null,Dt(e.features,l=>(T(),z(o,ne(e.$attrs,{key:l[e.sKey],class:"feature-popup-layer__item",visible:e.visible,geometry:l.geometry,orphan:!0}),{default:j(()=>[y(e.$slots,"default",{attributes:l?.attributes??{},geometry:l.geometry})]),_:2},1040,["visible","geometry"]))),128))]),_:3})}be.render=Ma;be.__file="feature-popup-layer/src/index.vue";be.install=e=>{e.component(be.name,be)};const Lt={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},ga=Ae(Lt),St={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},xa=re(St),$a={...Lt,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},ba=ga,La={load:e=>e,...St},Sa=xa;var si=m({props:Lt,emits:St,setup(e,{emit:t}){const i=on(),n=rn(),r=i.on("create",o=>{t("create",o),o.state==="start"?e.multiple||n.removeAll():o.state==="complete"&&(!e.multiple&&n.graphics.length>1&&o.graphic.geometry.type==="point"&&n.remove(n.graphics.getItemAt(0)),t("update:modelValue",[...n.graphics]),t("complete",o))});g(()=>{r.remove()});const a=i.on("update",o=>{t("update",o),o.state==="complete"&&(t("update:modelValue",[...n.graphics]),t("complete",o))});return g(()=>{a.remove()}),()=>null}});si.__file="sketch/src/events/index.vue";var Le=m({name:"VaSketch",components:{Events:si},emits:La,props:$a,setup(e,{emit:t}){const i=M(),n=i.map;let r=_("vaGraphicsLayer",null);r||(r=new Bt,n.add(r));const a=ba(e),o=Sa(t);function s(d){r.removeAll(),r.addMany(d)}E(()=>e.modelValue,(d,u)=>{let f=!1;if(d.length===u.length){for(let b=0;b<d.length;b++)if(d[b]!==u[b]){f=!0;break}}else f=!0;f&&s([...d])}),e.modelValueInitFrom==="layerGraphics"?t("update:modelValue",r.graphics):s(e.modelValue);const l=V(),c=V(!1);return ie(()=>{const d=new Mi({container:l.value,view:i,layer:r,creationMode:"single",...e.defaultOptions});p(()=>{e.visibleElements&&(d.visibleElements=e.visibleElements)}),p(()=>{e.viewModelPointSymbol&&(d.viewModel.pointSymbol=e.viewModelPointSymbol)}),p(()=>{e.viewModelPolylineSymbol&&(d.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),p(()=>{e.viewModelPolygonSymbol&&(d.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),p(()=>{e.viewModelActiveFillSymbol&&(d.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),p(()=>{e.availableCreatureTools&&(d.availableCreateTools=e.availableCreatureTools)}),g(()=>{d.destroy()}),Ze.useAddUi(i.ui,d,e),h("vaGraphicsLayer",r),h("vaSketch",d),c.value=!0,t("load",{sketch:d,view:i})}),{eventsBindProps:a,eventsOnEmits:o,sketchNode:l,ready:c}}});const Oa={ref:"sketchNode"};function _a(e,t,i,n,r,a){const o=w("Events");return T(),x("div",Oa,[e.ready?(T(),x(R,{key:0},[$(o,ne(e.eventsBindProps,k(e.eventsOnEmits)),null,16),y(e.$slots,"default")],64)):P("v-if",!0)],512)}Le.render=_a;Le.__file="sketch/src/index.vue";Le.install=e=>{e.component(Le.name,Le)};const Ca={...I.props,url:{type:String,default:""},defaultOptions:{type:Object,default:()=>({})},sublayers:{type:Array,default:void 0}},Va={load:e=>e};var Se=m({name:"VaMapImageLayer",components:{VaLayerWhen:G,VaSublayersProvider:q},emits:Va,props:Ca,setup(e,{emit:t}){const i=M(),n=i.map,r=new gi({...e.defaultOptions});return p(()=>{r.url=e.url}),p(()=>{e.sublayers&&(r.sublayers=e.sublayers)}),v.useSetLayerOptions(r,e),v.useAddLayer(n,r,e),h("vaLayer",r),h("vaMapImageLayer",r),t("load",{view:i,layer:r}),{}}});function Ra(e,t,i,n,r,a){const o=w("VaSublayersProvider"),s=w("VaLayerWhen");return T(),x(R,null,[y(e.$slots,"default"),$(s,null,{default:j(l=>[$(o,null,{default:j(()=>[y(e.$slots,"when",Fi(Ui(l)))]),_:2},1024)]),_:3})],64)}Se.render=Ra;Se.__file="map-image-layer/src/index.vue";Se.install=e=>{e.component(Se.name,Se)};const Ea={...I.props,defaultOptions:{type:Object,default:()=>({})},id:{type:Number,default:0},renderer:{type:Object,default:void 0},definitionExpression:{type:String,default:"1=1"}},Wa={load:e=>e};var Oe=m({name:"VaSublayer",emits:Wa,props:Ea,setup(e,{emit:t}){const i=X(),n=Xi(),r=Ft(),a=new xi({...e.defaultOptions}),o=a.when(),s=l().then(c=>{a.set("fullExtent",c.extent)});a.when=async function(...c){const[d,u]=c;return s.then(()=>o).then(f=>(d?.(f),f)).catch(f=>{u?.(f)})},p(()=>{a.id=e.id}),p(()=>{e.renderer!==void 0&&(a.renderer=e.renderer)}),p(()=>{a.definitionExpression=e.definitionExpression}),v.useSetLayerOptions(a,e),v.useAddLayer(n,a,e),h("vaSublayer",a),h("vaLayer",a),t("load",{view:i,sublayers:n,sublayer:a});async function l(){await r.when();const c=a.url;return(await $i(c,{query:{f:"json"}})).data}return{}}});function ja(e,t,i,n,r,a){return y(e.$slots,"default")}Oe.render=ja;Oe.__file="sublayer/src/index.vue";Oe.install=e=>{e.component(Oe.name,Oe)};const Ia={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0,default:""}},Ha={click:e=>e,pointerMove:e=>e,load:e=>e};var _e=m({name:"VaSceneLayer",components:{VaLayerHitEvents:B},emits:Ha,props:Ia,setup(e,{emit:t}){const i=ae.createOnEmits(t),n=en(),r=n.map,a=new bi({url:e.url,...e.defaultOptions});return p(()=>{a.url=e.url}),v.useAddLayer(r,a,e),v.useSetLayerOptions(a,e),h("vaSceneLayer",a),h("vaLayer",a),t("load",{layer:a,view:n}),{hitEmits:i}}});function Pa(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.hitEmits),null,16),y(e.$slots,"default")],64)}_e.render=Pa;_e.__file="scene-layer/src/index.vue";_e.install=e=>{e.component(_e.name,_e)};const Ba={type:{type:String,default:"",required:!0}};var Ne=m({name:"VaTreeLayerItem",props:Ba,setup(e){const t=_("vaTreeLayerGroupLayerItems");if(!t)throw new TypeError;const i=qi();return i&&(t[e.type]=i),()=>null}});Ne.__file="tree-layer-item/src/index.vue";Ne.install=e=>{e.component(Ne.name,Ne)};const ka={data:{type:Array,default:()=>[]}};var Fe=m({name:"VaTreeLayerGroup",props:ka,setup(e,t){const i=Gt({});h("vaTreeLayerGroupLayerItems",i);const n=t.slots;return()=>{const r=n.default(),o=(s=>{const l=[...s];let c=0;for(;l[c];){const d=l[c].children;d&&l.push(...d),c++}return l.reduce((d,u)=>{if(u.layer&&i[u.layer.type]){const f=i[u.layer.type].slots.default({layer:u.layer,node:u});Array.isArray(f)?f.forEach(b=>{d.push(b)}):d.push(f)}return d},[])})(e.data);return[r,o]}}});Fe.__file="tree-layer-group/src/index.vue";Fe.install=e=>{e.component(Fe.name,Fe)};const Aa=(e,t,i)=>{i.orphan||(p(()=>{e.add(t,i.position)}),pt(()=>{e.remove(t)}),yt(()=>{e.add(t,i.position)}),ft(()=>{e.remove(t)}))},Da={defaultOptions:{type:Object,default:()=>({})},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1}},Ga={load:e=>e};var Ce=m({name:"VaPrint",emits:Ga,props:Da,setup(e,{emit:t}){const i=M(),n=V(),r=V(!1);return ie(()=>{const a=new Li({container:n.value,view:i,...e.defaultOptions});Aa(i.ui,a,e),h("vaSketch",a),r.value=!0,t("load",{print:a,view:i}),g(()=>{a.destroy()})}),{uiNode:n,ready:r}}});const Na={ref:"uiNode",class:"va-print-x"};function Fa(e,t,i,n,r,a){return T(),x("div",Na,[e.ready?y(e.$slots,"default",{key:0}):P("v-if",!0)],512)}Ce.render=Fa;Ce.__file="print/src/index.vue";Ce.install=e=>{e.component(Ce.name,Ce)};const Ua={...I.props,color:{type:Array,default:()=>[0,0,0,.7]},geometry:{type:Object,default:void 0},distance:{type:Number,default:24},tileInfo:{type:Object,default:void 0},spatialReference:{type:Object,default:void 0}},qa={load:e=>e},za=Si.createSubclass({constructor(){this.tileContexts=new window.Map,this.watchHandles=new ki,this.needsImageUpdate=!1},attach(){const e=Oi(),t=this,i=t.layer;this.watchHandles.add([De(()=>this.layer.tileInfo,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0}),De(()=>this.layer.geometry,()=>{if(!i.geometry){t.projectedGeometry=null,t.needsImageUpdate=!0,t.requestRender();return}e.then(()=>{t.projectedGeometry=Vi(i.geometry,i.tileInfo.spatialReference,Ri(i.geometry.spatialReference,i.tileInfo.spatialReference)),t.needsImageUpdate=!0,t.requestRender()})},{initial:!0}),De(()=>this.layer.distance,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0}),De(()=>this.layer.color,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0})])},drawGeometry(e,t){e.globalCompositeOperation="source-over";const i=e.canvas.width,n=e.canvas.height;if(!this.projectedGeometry){e.clearRect(0,0,i,n);return}if(this.layer.distance===0)return;const r=this.layer.color;e.fillStyle="rgba("+r[0]+", "+r[1]+", "+r[2]+", 1)",e.fillRect(0,0,i,n);const a=3/this.layer.distance;if(e.globalCompositeOperation="destination-out",this.projectedGeometry.type==="polygon"||this.projectedGeometry.type==="polyline"||this.projectedGeometry.type==="extent"){const s=(this.projectedGeometry.type==="extent"?_i.fromExtent(this.projectedGeometry).rings:this.projectedGeometry.rings||this.projectedGeometry.paths).map(l=>l.map(c=>[Math.round(i*(c[0]-t[0])/(t[2]-t[0])),Math.round(n*(1-(c[1]-t[1])/(t[3]-t[1])))]));e.lineJoin="round";for(let l=1;l<=this.layer.distance;++l){e.strokeStyle="rgba(0, 0, 0, "+a+")",e.lineWidth=this.layer.distance+1-l;for(let c=0;c<s.length;++c){const d=s[c];e.beginPath(),e.moveTo(d[0][0],d[0][1]);for(let u=1;u<d.length;++u)e.lineTo(d[u][0],d[u][1]);this.projectedGeometry.type!=="polyline"&&e.closePath(),e.stroke()}}if(this.projectedGeometry.type!=="polyline"){e.fillStyle="rgba(0, 0, 0, 1)";for(let l=0;l<s.length;++l){const c=s[l];e.beginPath(),e.moveTo(c[0][0],c[0][1]);for(let d=1;d<c.length;++d)e.lineTo(c[d][0],c[d][1]);e.closePath(),e.fill()}}}else if(this.projectedGeometry.type==="point"||this.projectedGeometry.type==="multipoint"){const s=(this.projectedGeometry.type==="multipoint"?this.projectedGeometry.points:[[this.projectedGeometry.x,this.projectedGeometry.y]]).map(l=>[Math.round(i*(l[0]-t[0])/(t[2]-t[0])),Math.round(n*(1-(l[1]-t[1])/(t[3]-t[1])))]);for(let l=1;l<=this.layer.distance;++l){const c=this.layer.distance+1-l;e.fillStyle="rgba(0, 0, 0, "+a+")";for(let d=0;d<s.length;++d){const u=s[d];e.beginPath(),e.arc(u[0],u[1],Math.round(c/2),0,360),e.fill()}}}},manageTileImages(){const e=new Set;for(let t=0;t<this.tiles.length;++t){const i=this.tiles[t];e.add(i.id);let n=this.tileContexts.get(i.id);if(n)this.needsImageUpdate&&this.drawGeometry(n,i.bounds);else{const r=document.createElement("canvas");r.width=this.layer.tileInfo.size[0],r.height=this.layer.tileInfo.size[1],n=r.getContext("2d"),this.tileContexts.set(i.id,n),this.drawGeometry(n,i.bounds)}}this.tileContexts.forEach((t,i)=>{e.has(i)||this.tileContexts.delete(i)}),this.needsImageUpdate=!1},render(e){this.manageTileImages();const t=this.layer.tileInfo.size[0],i=e.state,n=i.pixelRatio,r=i.size[0],a=i.size[1],o=e.context,s=[0,0];o.clearRect(0,0,r*n,a*n),i.rotation!==0&&(o.translate(r*n*.5,a*n*.5),o.rotate(i.rotation*Math.PI/180),o.translate(-r*n*.5,-a*n*.5)),o.globalAlpha=this.layer.color[3];for(let l=0;l<this.tiles.length;++l){const c=this.tiles[l],d=this.tileContexts.get(c.id),u=c.resolution/i.resolution*n;i.toScreenNoRotation(s,c.coords),o.drawImage(d.canvas,s[0],s[1],t*u,t*u)}},detach(){this.watchHandles.removeAll()},tilesChanged(){}}),Xa=Ci(Ei).createSubclass({properties:{color:{},geometry:{},distance:{},tileInfo:ut.create({size:512})},constructor(){},createLayerView(e){if(e.type==="2d")return new za({view:e,layer:this})}});var Ve=m({name:"VaMaskingLayer",emits:qa,props:Ua,setup(e,{emit:t}){const i=M(),n=i.map,r=i.map.basemap.baseLayers.getItemAt(0),a=new Xa({color:e.color,distance:e.distance,geometry:e.geometry});return p(()=>{a.geometry=e.geometry,e.geometry&&!e.geometry.spatialReference&&i.when(()=>{a.geometry.spatialReference=e.spatialReference||i.spatialReference})}),p(()=>{a.color=e.color}),p(()=>{a.distance=e.distance}),p(()=>{i.when(()=>{a.tileInfo=e.tileInfo?e.tileInfo:r.tileInfo})}),v.useSetLayerOptions(a,e),v.useAddLayer(n,a,e),t("load",{view:i,layer:a}),{}}});function Ka(e,t,i,n,r,a){return y(e.$slots,"default")}Ve.render=Ka;Ve.__file="masking-layer/src/index.vue";Ve.install=e=>{e.component(Ve.name,Ve)};const Ya={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""},renderer:{type:Object,default:void 0}},Qa={load:e=>e};var Re=m({name:"VaImageryLayer",emits:Qa,props:Ya,setup(e,{emit:t}){const i=X(),n=i.map,r=new Wi({...e.defaultOptions});return p(()=>{r.url=e.url}),p(()=>{e.renderer!==void 0&&(r.renderer=e.renderer)}),v.useAddLayer(n,r,e),v.useSetLayerOptions(r,e),t("load",{layer:r,view:i}),h("vaLayer",r),h("vaImageryLayer",r),{}}});function Ja(e,t,i,n,r,a){return y(e.$slots,"default")}Re.render=Ja;Re.__file="imagery-layer/src/index.vue";Re.install=e=>{e.component(Re.name,Re)};const ci={effect:{type:Object,default:void 0},blendMode:{type:String,default:void 0}},Za=Ae(ci);var eo=Object.freeze({__proto__:null,createBindProps:Za,props:ci});function to(e,t){p(()=>{t.effect!==void 0&&(e.effect=t.effect)}),p(()=>{t.blendMode!==void 0&&(e.blendMode=t.blendMode)})}var io=Object.freeze({__proto__:null,useSetBlendLayerOptions:to});const no={...I.props,...eo.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0},renderer:{type:Object,default:void 0}},ro={load:e=>e};var Ee=m({name:"VaImageryTileLayer",emits:ro,props:no,setup(e,{emit:t}){const i=M(),n=i.map,r=new ji({...e.defaultOptions});return p(()=>{r.url=e.url}),p(()=>{e.renderer!==void 0&&(r.renderer=e.renderer)}),io.useSetBlendLayerOptions(r,e),v.useAddLayer(n,r,e),t("load",{view:i,layer:r}),{}}});function ao(e,t,i,n,r,a){return y(e.$slots,"default")}Ee.render=ao;Ee.__file="imagery-tile-layer/src/index.vue";Ee.install=e=>{e.component(Ee.name,Ee)};const oo={...ei.props,visible:{type:Boolean,default:!0}},lo={load:e=>e};var We=m({name:"VaZoom",emits:lo,props:oo,setup(e,{emit:t}){const i=X(),n=new Ii({view:i});return Ze.useAddUi(i.ui,n,e),Je(n,e),t("load",{ui:n,view:i}),{}}});function so(e,t,i,n,r,a){return y(e.$slots,"default")}We.render=so;We.__file="zoom/src/index.vue";We.install=e=>{e.component(We.name,We)};const co={...K.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String},namespaceUri:{type:String,default:void 0},name:{type:String},geometryType:{type:String},wfsLayerInfo:{type:Object,default:void 0},customParameters:{type:Object,default:()=>({})}},uo={load:e=>e,click:e=>e,pointerMove:e=>e};var je=m({name:"VaWfsLayer",components:{VaLayerHitEvents:B},emits:uo,props:co,setup(e,{emit:t}){const i=X(),n=i.map,r=ae.createOnEmits(t),a=e.wfsLayerInfo?_t.fromWFSLayerInfo(e.wfsLayerInfo):new _t({...e.defaultOptions});return te.useSetLayerOptions(a,e),p(()=>{e.url&&(a.url=e.url)}),p(()=>{e.name&&(a.name=e.name)}),p(()=>{e.namespaceUri&&(a.namespaceUri=e.namespaceUri)}),p(()=>{e.geometryType&&(a.geometryType=e.geometryType)}),E(()=>({...e.customParameters}),()=>{a.customParameters=e.customParameters,a.refresh()}),te.useSetLayerSpatialReference(i,a,e),v.useAddLayer(n,a,e),h("vaLayer",a),h("vaWfsLayer",a),t("load",{view:i,layer:a}),{hitEmits:r}}});function po(e,t,i,n,r,a){const o=w("VaLayerHitEvents");return T(),x(R,null,[$(o,k(e.hitEmits),null,16),y(e.$slots,"default")],64)}je.render=po;je.__file="wfs-layer/src/index.vue";je.install=e=>{e.component(je.name,je)};const mo={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""},sublayers:{type:Array},customParameters:{type:Object,default:()=>({})}},fo={load:e=>e};var Ie=m({name:"VaWmsLayer",emits:fo,props:mo,setup(e,{emit:t}){const i=X(),n=i.map,r=new Hi({...e.defaultOptions});p(()=>{r.url=e.url}),p(()=>{r.customParameters=e.customParameters,r.refresh()}),p(()=>{e.sublayers&&(r.sublayers=e.sublayers,a())}),r.when(a),v.useSetLayerOptions(r,e),v.useAddLayer(n,r,e),h("vaLayer",r),h("vaWmsLayer",r),t("load",{layer:r,view:i});function a(){if(e.sublayers?.length&&r.resourceInfo){const o=r.resourceInfo.layers.reduce((s,l)=>(s[l.name]=l,s),{});r.sublayers.forEach(s=>{let l=s.name;l.includes(":")&&(l=l.split(":")[1]);const c=o[l];c&&(s.title||(s.title=c.title),s.maxScale||(s.maxScale=c.maxScale),s.minScale||(s.minScale=c.minScale),s.fullExtent||(s.fullExtent=new dt(c.extent)))})}}return{layer:r}}});function yo(e,t,i,n,r,a){return y(e.$slots,"default")}Ie.render=yo;Ie.__file="wms-layer/src/index.vue";Ie.install=e=>{e.component(Ie.name,Ie)};const ho={...I.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0},serviceMode:{type:String,default:"RESTful"},customParameters:{type:Object,default:()=>({})},sublayers:{type:Array,default:void 0},activeLayer:{type:Object,default:void 0},overwriteCapabilities:{type:Object,default:void 0},subDomains:{type:Array,default:void 0}},vo={load:e=>e},To=function(e=new dt({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:{wkid:4326}})){const t=document.createElement("ows:WGS84BoundingBox"),i=document.createElement("ows:LowerCorner");i.textContent=e.xmin+" "+e.ymin;const n=document.createElement("ows:UpperCorner");return n.textContent=e.xmax+" "+e.ymax,t.appendChild(i),t.appendChild(n),t},wo=(e="PM")=>`<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:gml="http://www.opengis.net/gml" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.0.0" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0/wmtsGetCapabilities_response.xsd">
<TileMatrixSet>
<ows:Identifier>${e}</ows:Identifier>
<ows:SupportedCRS>EPSG:3857</ows:SupportedCRS>
<TileMatrix>
<ows:Identifier>0</ows:Identifier>
<ScaleDenominator>559082264.0287178958533332</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1</MatrixWidth>
<MatrixHeight>1</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>1</ows:Identifier>
<ScaleDenominator>279541132.0143588959472254</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2</MatrixWidth>
<MatrixHeight>2</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>2</ows:Identifier>
<ScaleDenominator>139770566.0071793960087234</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>4</MatrixWidth>
<MatrixHeight>4</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>3</ows:Identifier>
<ScaleDenominator>69885283.0035897239868063</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>8</MatrixWidth>
<MatrixHeight>8</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>4</ows:Identifier>
<ScaleDenominator>34942641.5017948619934032</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>16</MatrixWidth>
<MatrixHeight>16</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>5</ows:Identifier>
<ScaleDenominator>17471320.7508974309967016</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>32</MatrixWidth>
<MatrixHeight>32</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>6</ows:Identifier>
<ScaleDenominator>8735660.3754487154983508</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>64</MatrixWidth>
<MatrixHeight>64</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>7</ows:Identifier>
<ScaleDenominator>4367830.1877243577491754</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>128</MatrixWidth>
<MatrixHeight>128</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>8</ows:Identifier>
<ScaleDenominator>2183915.0938621788745877</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>256</MatrixWidth>
<MatrixHeight>256</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>9</ows:Identifier>
<ScaleDenominator>1091957.5469310886252288</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>512</MatrixWidth>
<MatrixHeight>512</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>10</ows:Identifier>
<ScaleDenominator>545978.7734655447186469</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1024</MatrixWidth>
<MatrixHeight>1024</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>11</ows:Identifier>
<ScaleDenominator>272989.3867327723085907</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2048</MatrixWidth>
<MatrixHeight>2048</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>12</ows:Identifier>
<ScaleDenominator>136494.6933663861796617</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>4096</MatrixWidth>
<MatrixHeight>4096</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>13</ows:Identifier>
<ScaleDenominator>68247.3466831930771477</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>8192</MatrixWidth>
<MatrixHeight>8192</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>14</ows:Identifier>
<ScaleDenominator>34123.6733415965449154</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>16384</MatrixWidth>
<MatrixHeight>16384</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>15</ows:Identifier>
<ScaleDenominator>17061.8366707982724577</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>32768</MatrixWidth>
<MatrixHeight>32768</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>16</ows:Identifier>
<ScaleDenominator>8530.9183353991362289</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>65536</MatrixWidth>
<MatrixHeight>65536</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>17</ows:Identifier>
<ScaleDenominator>4265.4591676995681144</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>131072</MatrixWidth>
<MatrixHeight>131072</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>18</ows:Identifier>
<ScaleDenominator>2132.7295838497840572</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>262144</MatrixWidth>
<MatrixHeight>262144</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>19</ows:Identifier>
<ScaleDenominator>1066.3647919248918304</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>524288</MatrixWidth>
<MatrixHeight>524288</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>20</ows:Identifier>
<ScaleDenominator>533.1823959624461134</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1048576</MatrixWidth>
<MatrixHeight>1048576</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>21</ows:Identifier>
<ScaleDenominator>266.5911979812228585</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2097152</MatrixWidth>
<MatrixHeight>2097152</MatrixHeight>
</TileMatrix>
</TileMatrixSet>
</Capabilities>
`,Mo=(e="PM")=>`<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:gml="http://www.opengis.net/gml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0.0/wmtsGetCapabilities_response.xsd" version="1.0.0">
<TileMatrixSetLink>
<TileMatrixSet>${e}</TileMatrixSet>
<TileMatrixSetLimits>
<TileMatrixLimits>
<TileMatrix>0</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>1</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>1</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>1</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>2</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>2</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>2</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>4</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>4</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>3</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>8</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>8</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>4</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>16</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>16</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>5</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>32</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>32</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>6</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>64</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>64</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>7</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>128</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>128</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>8</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>256</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>256</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>9</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>512</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>512</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>10</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>1024</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>1024</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>11</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>2048</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>2048</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>12</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>4096</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>4096</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>13</TileMatrix>
<MinTileRow>2736</MinTileRow>
<MaxTileRow>4639</MaxTileRow>
<MinTileCol>32</MinTileCol>
<MaxTileCol>7935</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>14</TileMatrix>
<MinTileRow>5472</MinTileRow>
<MaxTileRow>9263</MaxTileRow>
<MinTileCol>80</MinTileCol>
<MaxTileCol>15855</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>15</TileMatrix>
<MinTileRow>10944</MinTileRow>
<MaxTileRow>18527</MaxTileRow>
<MinTileCol>160</MinTileCol>
<MaxTileCol>31695</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>16</TileMatrix>
<MinTileRow>21904</MinTileRow>
<MaxTileRow>37039</MaxTileRow>
<MinTileCol>320</MinTileCol>
<MaxTileCol>63391</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>17</TileMatrix>
<MinTileRow>43808</MinTileRow>
<MaxTileRow>74063</MaxTileRow>
<MinTileCol>656</MinTileCol>
<MaxTileCol>126767</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>18</TileMatrix>
<MinTileRow>87616</MinTileRow>
<MaxTileRow>148111</MaxTileRow>
<MinTileCol>1312</MinTileCol>
<MaxTileCol>253535</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>19</TileMatrix>
<MinTileRow>175248</MinTileRow>
<MaxTileRow>294063</MaxTileRow>
<MinTileCol>170144</MinTileCol>
<MaxTileCol>343487</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>20</TileMatrix>
<MinTileRow>357008</MinTileRow>
<MaxTileRow>384687</MaxTileRow>
<MinTileCol>524400</MinTileCol>
<MaxTileCol>540927</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>21</TileMatrix>
<MinTileRow>714032</MinTileRow>
<MaxTileRow>768783</MaxTileRow>
<MinTileCol>1048816</MinTileCol>
<MaxTileCol>1081775</MaxTileCol>
</TileMatrixLimits>
</TileMatrixSetLimits>
</TileMatrixSetLink>
</Capabilities>
`,go=(e="PM")=>{const t=new DOMParser().parseFromString(wo(e),"text/xml").getElementsByTagName("TileMatrixSet")[0],i=new DOMParser().parseFromString(Mo(e),"text/xml").getElementsByTagName("TileMatrixSetLink")[0];return{TileMatrixSet:t,TileMatrixSetLink:i}},xo={PM:go};var He=m({name:"VaWmtsLayer",props:ho,emits:vo,setup(e,{emit:t}){const i=X(),n=i.map,r=A(()=>e.overwriteCapabilities?.replaceTileMatrixSets.reduce((l,c)=>(l[c.find]=xo[c.replacement](c.find),l),{})??{}),{interceptorToggle:a}=Zi({urls:[new RegExp(`${e.url}.*VUESRI=VaWmtsLayer`)],before(l){const c=e.subDomains;c&&(l.url=l.url.replace("{subDomain}",c[Math.floor(Math.random()*c.length)]))},after(l){if(l.url?.includes("request=GetCapabilities")){const c=l.data,u=new DOMParser().parseFromString(c,"application/xml"),f=u.getElementsByTagName("Contents")[0],b=u.getElementsByTagName("Layer");for(let L=0;L<b.length;L++){const C=b[L],H=C.getElementsByTagName("TileMatrixSetLink");for(let Y=0;Y<H.length;Y++){const Q=H[Y];Q.textContent&&r.value[Q.textContent]&&Q.replaceWith(r.value[Q.textContent].TileMatrixSetLink)}const oe=C.getElementsByTagName("ows:Identifier")[0];oe&&e.activeLayer?.id&&e.overwriteCapabilities?.extend&&e.activeLayer.id===oe.textContent&&C.getElementsByTagName("ows:WGS84BoundingBox")[0].replaceWith(To(e.overwriteCapabilities.extend))}const O=f.getElementsByTagName("TileMatrixSet");for(let L=0;L<O.length;L++){const C=O[L],H=C.getElementsByTagName("ows:Identifier")[0];H&&r.value[H.textContent]&&C.replaceWith(r.value[H.textContent].TileMatrixSet)}l.data=u.documentElement.outerHTML}}});a.add();const o=new Pi({...e.activeLayer?{activeLayer:e.activeLayer}:{},...e.defaultOptions}),s=Ke({});return o.when(()=>{s.value=o.sublayers.reduce((l,c)=>(l[c.id]=c,l),{})}),p(()=>{o.url=e.url}),p(()=>{o.serviceMode=e.serviceMode}),p(()=>{o.customParameters={...e.customParameters,VUESRI:"VaWmtsLayer"}}),p(()=>{e.sublayers&&(o.sublayers=e.sublayers)}),E(()=>[e.activeLayer?.id,e.activeLayer?.imageFormat],([l,c])=>{l&&o.when().then(()=>{const d=s.value[l];c&&(d.imageFormat=c),o.activeLayer=d,o.refresh()})},{immediate:!0}),p(()=>{o.title=e.title}),v.useSetLayerOptions(o,e),v.useAddLayer(n,o,e),h("vaLayer",o),h("vaWmtsLayer",o),t("load",{view:i,layer:o}),{}}});function $o(e,t,i,n,r,a){return y(e.$slots,"default")}He.render=$o;He.__file="wmts-layer/src/index.vue";He.install=e=>{e.component(He.name,He)};const bo={...ei.props,defaultOptions:{type:Object,default:()=>({})},viewModel:{type:Object,default:()=>({})}},Lo={load:e=>e};var Pe=m({name:"VaSlice",props:bo,emits:Lo,setup(e,{emit:t}){const i=zi(),n=new Bi({view:i,...e.defaultOptions});return E(()=>({...e.viewModel}),()=>{Reflect.ownKeys(e.viewModel).forEach(r=>{n.viewModel[r]=e.viewModel[r]})},{immediate:!0}),Ze.useAddUi(i.ui,n,e),{}}});function So(e,t,i,n,r,a){return y(e.$slots,"default")}Pe.render=So;Pe.__file="slice/src/index.vue";Pe.install=e=>{e.component(Pe.name,Pe)};export{Ye as T,N as a,Te as b,zi as c,U as d,W as o,Be as s};
